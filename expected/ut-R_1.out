LOAD 'pg_hint_plan';
SET pg_hint_plan.enable_hint TO on;
SET pg_hint_plan.debug_print TO on;
SET client_min_messages TO LOG;
SET search_path TO public;
LOG:  statement: SET search_path TO public;
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-1-1 specified pattern of the object name
----
-- No. R-1-1-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-1-2
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1 t_1, s1.t2 t_2 WHERE t_1.c1 = t_2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1 t_1, s1.t2 t_2 WHERE t_1.c1 = t_2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(t1 t2 #1)
duplication hint:
error hint:

                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t_1.c1 = t_2.c1)
   ->  Index Scan using t1_i1 on t1 t_1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t_2.c1
         ->  Seq Scan on t2 t_2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-1-3
/*+Rows(t_1 t_2 #1)*/
EXPLAIN SELECT * FROM s1.t1 t_1, s1.t2 t_2 WHERE t_1.c1 = t_2.c1;
LOG:  statement: /*+Rows(t_1 t_2 #1)*/
EXPLAIN SELECT * FROM s1.t1 t_1, s1.t2 t_2 WHERE t_1.c1 = t_2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t_1 t_2 #1)
not used hint:
duplication hint:
error hint:

                                  QUERY PLAN                                   
-------------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t_1.c1 = t_2.c1)
   ->  Index Scan using t1_i1 on t1 t_1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t_2.c1
         ->  Seq Scan on t2 t_2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-1-2 specified schema name in the hint option
----
-- No. R-1-2-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-2-2
/*+Rows(s1.t1 s1.t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(s1.t1 s1.t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(s1.t1 s1.t2 #1)
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-1-3 table doesn't exist in the hint option
----
-- No. R-1-3-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-3-2
/*+Rows(t3 t4 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t3 t4 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(t3 t4 #1)
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-1-4 conflict table name
----
-- No. R-1-4-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-4-2
EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t1_1.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t1_1.c1
         ->  Seq Scan on t1 t1_1  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
LOG:  statement: /*+Rows(t1 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t1 #1)"
DETAIL:  Relation name "t1" is ambiguous.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
Rows(t1 t1 #1)

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t1_1.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t1_1.c1
         ->  Seq Scan on t1 t1_1  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(s1.t1 s2.t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
LOG:  statement: /*+Rows(s1.t1 s2.t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 WHERE s1.t1.c1 = s2.t1.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(s1.t1 s2.t1 #1)
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t1_1.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t1_1.c1
         ->  Seq Scan on t1 t1_1  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

EXPLAIN SELECT * FROM s1.t1, s2.t1 s2t1 WHERE s1.t1.c1 = s2t1.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s2.t1 s2t1 WHERE s1.t1.c1 = s2t1.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = s2t1.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: s2t1.c1
         ->  Seq Scan on t1 s2t1  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 s2t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 s2t1 WHERE s1.t1.c1 = s2t1.c1;
LOG:  statement: /*+Rows(t1 s2t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s2.t1 s2t1 WHERE s1.t1.c1 = s2t1.c1;
LOG:  pg_hint_plan:
used hint:
Rows(s2t1 t1 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = s2t1.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: s2t1.c1
         ->  Seq Scan on t1 s2t1  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-4-3
EXPLAIN SELECT *, (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT *, (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Merge Join  (cost=17.60..23.75 rows=100 width=33)
   Merge Cond: (t1.c1 = t2.c1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=12.00..12.01 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
                 Merge Cond: (t1_1.c1 = t2_1.c1)
                 ->  Index Only Scan using t1_i1 on t1 t1_1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: t2_1.c1
                       ->  Seq Scan on t2 t2_1  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(14 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT *, (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT *, (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Merge Join  (cost=17.36..23.51 rows=100 width=33)
   Merge Cond: (t1.c1 = t2.c1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=11.75..11.76 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
                 Merge Cond: (t1_1.c1 = t2_1.c1)
                 ->  Index Only Scan using t1_i1 on t1 t1_1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: t2_1.c1
                       ->  Seq Scan on t2 t2_1  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(14 rows)

/*+Rows(st1 st2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT *, (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(st1 st2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT *, (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(st1 st2 #1)
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Merge Join  (cost=17.36..23.51 rows=1 width=33)
   Merge Cond: (t1.c1 = t2.c1)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=11.75..11.76 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
                 Merge Cond: (st1.c1 = st2.c1)
                 ->  Index Only Scan using t1_i1 on t1 st1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: st2.c1
                       ->  Seq Scan on t2 st2  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(14 rows)

----
---- No. R-1-5 conflict table name
----
-- No. R-1-5-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-5-2
/*+Rows(t1 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t1 #1)"
DETAIL:  Relation name "t1" is duplicated.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
Rows(t1 t1 #1)

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-5-3
/*+(t1 t1)(t2 t2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+(t1 t1)(t2 t2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "(t1 t1)(t2 t2)"
DETAIL:  Unrecognized hint keyword "".
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

EXPLAIN SELECT * FROM s1.t1, s1.t2, s1.t3 WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2, s1.t3 WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Merge Join  (cost=5.75..19.53 rows=100 width=73)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Merge Join  (cost=0.43..120.70 rows=1000 width=59)
         Merge Cond: (t1.c1 = t3.c1)
         ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
         ->  Index Scan using t3_i1 on t3  (cost=0.15..61.10 rows=1130 width=44)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(9 rows)

/*+(t1 t2 t1 t2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, s1.t3, s1.t4 WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
LOG:  statement: /*+(t1 t2 t1 t2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, s1.t3, s1.t4 WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
INFO:  pg_hint_plan: hint syntax error at or near "(t1 t2 t1 t2)"
DETAIL:  Unrecognized hint keyword "".
                                      QUERY PLAN                                       
---------------------------------------------------------------------------------------
 Nested Loop  (cost=5.90..40.93 rows=100 width=117)
   ->  Merge Join  (cost=5.75..19.53 rows=100 width=73)
         Merge Cond: (t1.c1 = t2.c1)
         ->  Merge Join  (cost=0.43..120.70 rows=1000 width=59)
               Merge Cond: (t1.c1 = t3.c1)
               ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
               ->  Index Scan using t3_i1 on t3  (cost=0.15..61.10 rows=1130 width=44)
         ->  Sort  (cost=5.32..5.57 rows=100 width=14)
               Sort Key: t2.c1
               ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
   ->  Index Scan using t4_i1 on t4  (cost=0.15..0.21 rows=1 width=44)
         Index Cond: (c1 = t1.c1)
(12 rows)

----
---- No. R-1-6 object type for the hint
----
-- No. R-1-6-1
/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-6-2
EXPLAIN SELECT * FROM s1.p1 t1, s1.p1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.p1 t1, s1.p1 t2 WHERE t1.c1 = t2.c1;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Hash Join  (cost=11.27..22.91 rows=301 width=30)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Append  (cost=0.00..7.50 rows=301 width=15)
         ->  Seq Scan on p1 t1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p1c1 t1_1  (cost=0.00..2.00 rows=100 width=14)
         ->  Seq Scan on p1c2 t1_2  (cost=0.00..2.00 rows=100 width=16)
         ->  Seq Scan on p1c3 t1_3  (cost=0.00..2.00 rows=100 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1 t2  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1 t2_1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2 t2_2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3 t2_3  (cost=0.00..2.00 rows=100 width=16)
(13 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.p1 t1, s1.p1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.p1 t1, s1.p1 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Hash Join  (cost=11.27..22.91 rows=1 width=30)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Append  (cost=0.00..7.50 rows=301 width=15)
         ->  Seq Scan on p1 t1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p1c1 t1_1  (cost=0.00..2.00 rows=100 width=14)
         ->  Seq Scan on p1c2 t1_2  (cost=0.00..2.00 rows=100 width=16)
         ->  Seq Scan on p1c3 t1_3  (cost=0.00..2.00 rows=100 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1 t2  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1 t2_1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2 t2_2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3 t2_3  (cost=0.00..2.00 rows=100 width=16)
(13 rows)

-- No. R-1-6-3
EXPLAIN SELECT * FROM s1.ul1 t1, s1.ul1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.ul1 t1, s1.ul1 t2 WHERE t1.c1 = t2.c1;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Hash Join  (cost=35.43..59.70 rows=1130 width=88)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Seq Scan on ul1 t1  (cost=0.00..21.30 rows=1130 width=44)
   ->  Hash  (cost=21.30..21.30 rows=1130 width=44)
         ->  Seq Scan on ul1 t2  (cost=0.00..21.30 rows=1130 width=44)
(5 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.ul1 t1, s1.ul1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.ul1 t1, s1.ul1 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                              QUERY PLAN                               
-----------------------------------------------------------------------
 Hash Join  (cost=35.43..59.70 rows=1 width=88)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Seq Scan on ul1 t1  (cost=0.00..21.30 rows=1130 width=44)
   ->  Hash  (cost=21.30..21.30 rows=1130 width=44)
         ->  Seq Scan on ul1 t2  (cost=0.00..21.30 rows=1130 width=44)
(5 rows)

-- No. R-1-6-4
CREATE TEMP TABLE tm1 (LIKE s1.t1 INCLUDING ALL);
LOG:  statement: CREATE TEMP TABLE tm1 (LIKE s1.t1 INCLUDING ALL);
EXPLAIN SELECT * FROM tm1 t1, tm1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM tm1 t1, tm1 t2 WHERE t1.c1 = t2.c1;
                              QUERY PLAN                               
-----------------------------------------------------------------------
 Hash Join  (cost=35.43..59.70 rows=1130 width=88)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Seq Scan on tm1 t1  (cost=0.00..21.30 rows=1130 width=44)
   ->  Hash  (cost=21.30..21.30 rows=1130 width=44)
         ->  Seq Scan on tm1 t2  (cost=0.00..21.30 rows=1130 width=44)
(5 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM tm1 t1, tm1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM tm1 t1, tm1 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                              QUERY PLAN                               
-----------------------------------------------------------------------
 Hash Join  (cost=35.43..59.70 rows=1 width=88)
   Hash Cond: (t1.c1 = t2.c1)
   ->  Seq Scan on tm1 t1  (cost=0.00..21.30 rows=1130 width=44)
   ->  Hash  (cost=21.30..21.30 rows=1130 width=44)
         ->  Seq Scan on tm1 t2  (cost=0.00..21.30 rows=1130 width=44)
(5 rows)

-- No. R-1-6-5
CREATE TEMP TABLE t_pg_class WITH OIDS AS SELECT * from pg_class LIMIT 100;
LOG:  statement: CREATE TEMP TABLE t_pg_class WITH OIDS AS SELECT * from pg_class LIMIT 100;
EXPLAIN SELECT * FROM t_pg_class t1, t_pg_class t2 WHERE t1.oid = t2.oid;
LOG:  statement: EXPLAIN SELECT * FROM t_pg_class t1, t_pg_class t2 WHERE t1.oid = t2.oid;
                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Hash Join  (cost=16.75..33.88 rows=300 width=482)
   Hash Cond: (t1.oid = t2.oid)
   ->  Seq Scan on t_pg_class t1  (cost=0.00..13.00 rows=300 width=245)
   ->  Hash  (cost=13.00..13.00 rows=300 width=245)
         ->  Seq Scan on t_pg_class t2  (cost=0.00..13.00 rows=300 width=245)
(5 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM t_pg_class t1, t_pg_class t2 WHERE t1.oid = t2.oid;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM t_pg_class t1, t_pg_class t2 WHERE t1.oid = t2.oid;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                  QUERY PLAN                                  
------------------------------------------------------------------------------
 Hash Join  (cost=16.75..33.88 rows=1 width=482)
   Hash Cond: (t1.oid = t2.oid)
   ->  Seq Scan on t_pg_class t1  (cost=0.00..13.00 rows=300 width=245)
   ->  Hash  (cost=13.00..13.00 rows=300 width=245)
         ->  Seq Scan on t_pg_class t2  (cost=0.00..13.00 rows=300 width=245)
(5 rows)

-- No. R-1-6-6
-- refer ut-fdw.sql
-- No. R-1-6-7
EXPLAIN SELECT * FROM s1.f1() t1, s1.f1() t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.f1() t1, s1.f1() t2 WHERE t1.c1 = t2.c1;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Nested Loop  (cost=0.50..0.53 rows=1 width=88)
   Join Filter: (t1.c1 = t2.c1)
   ->  Function Scan on f1 t1  (cost=0.25..0.26 rows=1 width=44)
   ->  Function Scan on f1 t2  (cost=0.25..0.26 rows=1 width=44)
(4 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.f1() t1, s1.f1() t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.f1() t1, s1.f1() t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                           QUERY PLAN                            
-----------------------------------------------------------------
 Nested Loop  (cost=0.50..0.53 rows=1 width=88)
   Join Filter: (t1.c1 = t2.c1)
   ->  Function Scan on f1 t1  (cost=0.25..0.26 rows=1 width=44)
   ->  Function Scan on f1 t2  (cost=0.25..0.26 rows=1 width=44)
(4 rows)

-- No. R-1-6-8
EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=0.07..2.48 rows=3 width=58)
   Hash Cond: (t2.c1 = "*VALUES*".column1)
   ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
   ->  Hash  (cost=0.04..0.04 rows=3 width=44)
         ->  Values Scan on "*VALUES*"  (cost=0.00..0.04 rows=3 width=44)
(5 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(t1 t2 #1)
duplication hint:
error hint:

                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=0.07..2.48 rows=3 width=58)
   Hash Cond: (t2.c1 = "*VALUES*".column1)
   ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
   ->  Hash  (cost=0.04..0.04 rows=3 width=44)
         ->  Values Scan on "*VALUES*"  (cost=0.00..0.04 rows=3 width=44)
(5 rows)

/*+Rows(*VALUES* t2 #1)*/
EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(*VALUES* t2 #1)*/
EXPLAIN SELECT * FROM (VALUES(1,1,1,'1'), (2,2,2,'2'), (3,3,3,'3')) AS t1 (c1, c2, c3, c4),  s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(*VALUES* t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=0.07..2.48 rows=1 width=58)
   Hash Cond: (t2.c1 = "*VALUES*".column1)
   ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
   ->  Hash  (cost=0.04..0.04 rows=3 width=44)
         ->  Values Scan on "*VALUES*"  (cost=0.00..0.04 rows=3 width=44)
(5 rows)

-- No. R-1-6-9
EXPLAIN WITH c1(c1) AS (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) SELECT * FROM s1.t1, c1 WHERE t1.c1 = c1.c1;
LOG:  statement: EXPLAIN WITH c1(c1) AS (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) SELECT * FROM s1.t1, c1 WHERE t1.c1 = c1.c1;
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Nested Loop  (cost=12.28..20.34 rows=1 width=19)
   CTE c1
     ->  Aggregate  (cost=12.00..12.01 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
                 Merge Cond: (t1_1.c1 = t2.c1)
                 ->  Index Only Scan using t1_i1 on t1 t1_1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: t2.c1
                       ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=4)
   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..8.29 rows=1 width=15)
         Index Cond: (c1 = c1.c1)
(12 rows)

/*+Rows(t1 t2 #1)Rows(t1 c1 +1)*/
EXPLAIN WITH c1(c1) AS (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) SELECT * FROM s1.t1, c1 WHERE t1.c1 = c1.c1;
LOG:  statement: /*+Rows(t1 t2 #1)Rows(t1 c1 +1)*/
EXPLAIN WITH c1(c1) AS (SELECT max(t1.c1) FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1) SELECT * FROM s1.t1, c1 WHERE t1.c1 = c1.c1;
LOG:  pg_hint_plan:
used hint:
Rows(c1 t1 +1)
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Nested Loop  (cost=12.03..20.09 rows=2 width=19)
   CTE c1
     ->  Aggregate  (cost=11.75..11.76 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
                 Merge Cond: (t1_1.c1 = t2.c1)
                 ->  Index Only Scan using t1_i1 on t1 t1_1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: t2.c1
                       ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=4)
   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..8.29 rows=1 width=15)
         Index Cond: (c1 = c1.c1)
(12 rows)

-- No. R-1-6-10
EXPLAIN SELECT * FROM s1.v1 t1, s1.v1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.v1 t1, s1.v1 t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (v1t1.c1 = v1t1_1.c1)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 v1t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.v1 t1, s1.v1 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.v1 t1, s1.v1 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(t1 t2 #1)
duplication hint:
error hint:

                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (v1t1.c1 = v1t1_1.c1)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 v1t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

/*+Rows(v1t1 v1t1_ #1)*/
EXPLAIN SELECT * FROM s1.v1 t1, s1.v1_ t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(v1t1 v1t1_ #1)*/
EXPLAIN SELECT * FROM s1.v1 t1, s1.v1_ t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(v1t1 v1t1_ #1)
not used hint:
duplication hint:
error hint:

                               QUERY PLAN                                
-------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1 width=30)
   Hash Cond: (v1t1.c1 = v1t1_.c1)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 v1t1_  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

-- No. R-1-6-11
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1 AND t1.c1 = (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1);
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1 AND t1.c1 = (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1);
                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Nested Loop  (cost=12.28..22.56 rows=1 width=29)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=12.00..12.01 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
                 Merge Cond: (st1.c1 = st2.c1)
                 ->  Index Only Scan using t1_i1 on t1 st1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: st2.c1
                       ->  Seq Scan on t2 st2  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..8.29 rows=1 width=15)
         Index Cond: (c1 = $0)
   ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=14)
         Filter: (c1 = $0)
(13 rows)

/*+Rows(t1 t2 #1)Rows(st1 st2 #1)*/
EXPLAIN (COSTS true) SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1 AND t1.c1 = (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1);
LOG:  statement: /*+Rows(t1 t2 #1)Rows(st1 st2 #1)*/
EXPLAIN (COSTS true) SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1 AND t1.c1 = (SELECT max(st1.c1) FROM s1.t1 st1, s1.t2 st2 WHERE st1.c1 = st2.c1);
LOG:  pg_hint_plan:
used hint:
Rows(st1 st2 #1)
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                           QUERY PLAN                                            
-------------------------------------------------------------------------------------------------
 Nested Loop  (cost=12.03..22.31 rows=1 width=29)
   InitPlan 1 (returns $0)
     ->  Aggregate  (cost=11.75..11.76 rows=1 width=4)
           ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
                 Merge Cond: (st1.c1 = st2.c1)
                 ->  Index Only Scan using t1_i1 on t1 st1  (cost=0.28..44.27 rows=1000 width=4)
                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                       Sort Key: st2.c1
                       ->  Seq Scan on t2 st2  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..8.29 rows=1 width=15)
         Index Cond: (c1 = $0)
   ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=14)
         Filter: (c1 = $0)
(13 rows)

--
-- There are cases where difference in the measured value and predicted value
-- depending upon the version of PostgreSQL
--
EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=19)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=4)
(6 rows)

/*+Rows(t1 st2 #1)*/
EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
LOG:  statement: /*+Rows(t1 st2 #1)*/
EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(st2 t1 #1)
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=19)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=4)
(6 rows)

/*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, (SELECT t2.c1 FROM s1.t2) st2 WHERE t1.c1 = st2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=19)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=4)
(6 rows)

----
---- No. R-1-7 specified number of conditions
----
-- No. R-1-7-1
/*+Rows(t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near ""
DETAIL:  Rows hint requires at least two relations.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
Rows(t1 #1)

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-7-2
/*+Rows(t1 t2 1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "1"
DETAIL:  Unrecognized rows value type notation.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
Rows(t1 t2 1)

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-1-7-3
/*+Rows(t1 t2 #notrows)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #notrows)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "notrows"
DETAIL:  Rows hint requires valid number as rows estimation.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
Rows(t1 t2 #notrows)

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-2-1 some complexity query blocks
----
-- No. R-2-1-1
/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=537.24..537.25 rows=1 width=12)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Nested Loop  (cost=13.15..60.93 rows=100 width=4)
         ->  Hash Join  (cost=13.00..39.53 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=11.75..11.75 rows=100 width=8)
                     ->  Merge Join  (cost=5.60..11.75 rows=100 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(43 rows)

/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(bmt1 bmt2 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(bmt1 bmt2 bmt3 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=293.30..293.31 rows=1 width=12)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Nested Loop  (cost=11.91..37.52 rows=1 width=4)
         ->  Hash Join  (cost=11.76..37.31 rows=1 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=11.75..11.75 rows=1 width=8)
                     ->  Merge Join  (cost=5.60..11.75 rows=1 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(43 rows)

-- No. R-2-1-2
/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
), (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
), (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=685.49..685.50 rows=1 width=16)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   InitPlan 3 (returns $5)
     ->  Aggregate  (cost=148.24..148.25 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..147.99 rows=100 width=4)
                 ->  Hash Join  (cost=3.68..126.59 rows=100 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=13.15..60.93 rows=100 width=4)
         ->  Hash Join  (cost=13.00..39.53 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=11.75..11.75 rows=100 width=8)
                     ->  Merge Join  (cost=5.60..11.75 rows=100 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(56 rows)

/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
), (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
SELECT max(bmt1.c1), (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
), (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
), (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(b3t1 b3t4 #1)
Rows(bmt1 bmt2 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t4 #1)
Rows(bmt1 bmt2 bmt3 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t3 b3t4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=417.48..417.49 rows=1 width=16)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   InitPlan 3 (returns $5)
     ->  Aggregate  (cost=124.17..124.18 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..124.17 rows=1 width=4)
                 ->  Hash Join  (cost=3.68..123.96 rows=1 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=11.91..37.52 rows=1 width=4)
         ->  Hash Join  (cost=11.76..37.31 rows=1 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=11.75..11.75 rows=1 width=8)
                     ->  Merge Join  (cost=5.60..11.75 rows=1 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(56 rows)

-- No. R-2-1-3
/*+
Leading(bmt4 bmt3 bmt2 bmt1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
not used hint:
duplication hint:
error hint:

                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Aggregate  (cost=75.93..75.94 rows=1 width=4)
   ->  Merge Join  (cost=69.53..75.68 rows=100 width=4)
         Merge Cond: (bmt1.c1 = bmt2.c1)
         ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
         ->  Sort  (cost=69.25..69.50 rows=100 width=12)
               Sort Key: bmt2.c1
               ->  Hash Join  (cost=38.68..65.93 rows=100 width=12)
                     Hash Cond: (bmt3.c1 = bmt2.c1)
                     ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                           Hash Cond: (bmt3.c1 = bmt4.c1)
                           ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                           ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                 ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                           ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
(15 rows)

/*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 #1)Rows(bmt4 bmt3 bmt2 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 #1)Rows(bmt4 bmt3 bmt2 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt3 bmt4 #1)
Rows(bmt2 bmt3 bmt4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Aggregate  (cost=60.22..60.23 rows=1 width=4)
   ->  Nested Loop  (cost=35.84..60.22 rows=1 width=4)
         Join Filter: (bmt2.c1 = bmt1.c1)
         ->  Nested Loop  (cost=35.57..59.87 rows=1 width=12)
               ->  Hash Join  (cost=35.43..59.70 rows=1 width=8)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                           ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
         ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..0.33 rows=1 width=4)
               Index Cond: (c1 = bmt3.c1)
(13 rows)

-- No. R-2-1-4
/*+
Leading(bmt4 bmt3 bmt2 bmt1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
not used hint:
duplication hint:
error hint:

                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Aggregate  (cost=75.93..75.94 rows=1 width=4)
   ->  Merge Join  (cost=69.53..75.68 rows=100 width=4)
         Merge Cond: (bmt1.c1 = bmt2.c1)
         ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
         ->  Sort  (cost=69.25..69.50 rows=100 width=12)
               Sort Key: bmt2.c1
               ->  Hash Join  (cost=38.68..65.93 rows=100 width=12)
                     Hash Cond: (bmt3.c1 = bmt2.c1)
                     ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                           Hash Cond: (bmt3.c1 = bmt4.c1)
                           ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                           ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                 ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                           ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
(15 rows)

/*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 #1)Rows(bmt4 bmt3 bmt2 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 #1)Rows(bmt4 bmt3 bmt2 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
*/
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt3 bmt4 #1)
Rows(bmt2 bmt3 bmt4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Aggregate  (cost=60.22..60.23 rows=1 width=4)
   ->  Nested Loop  (cost=35.84..60.22 rows=1 width=4)
         Join Filter: (bmt2.c1 = bmt1.c1)
         ->  Nested Loop  (cost=35.57..59.87 rows=1 width=12)
               ->  Hash Join  (cost=35.43..59.70 rows=1 width=8)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                           ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
         ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..0.33 rows=1 width=4)
               Index Cond: (c1 = bmt3.c1)
(13 rows)

-- No. R-2-1-5
/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
);
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
);
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=537.76..537.77 rows=1 width=4)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Nested Loop  (cost=13.66..61.45 rows=100 width=4)
         ->  Hash Join  (cost=13.51..40.04 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=12.26..12.26 rows=100 width=8)
                     ->  Merge Join  (cost=5.60..12.26 rows=100 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..49.27 rows=998 width=4)
                                 Filter: ((c1 <> $1) AND (c1 <> $3))
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(44 rows)

/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(bmt1 bmt2 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(bmt1 bmt2 bmt3 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=293.81..293.82 rows=1 width=4)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Nested Loop  (cost=12.42..38.03 rows=1 width=4)
         ->  Hash Join  (cost=12.27..37.82 rows=1 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=12.26..12.26 rows=1 width=8)
                     ->  Merge Join  (cost=5.60..12.26 rows=1 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..49.27 rows=998 width=4)
                                 Filter: ((c1 <> $1) AND (c1 <> $3))
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(44 rows)

-- No. R-2-1-6
/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
  AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
) AND bmt1.c1 <> (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
  AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
) AND bmt1.c1 <> (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=686.27..686.28 rows=1 width=4)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   InitPlan 3 (returns $5)
     ->  Aggregate  (cost=148.24..148.25 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..147.99 rows=100 width=4)
                 ->  Hash Join  (cost=3.68..126.59 rows=100 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=13.91..61.71 rows=100 width=4)
         ->  Hash Join  (cost=13.76..40.30 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=12.51..12.51 rows=100 width=8)
                     ->  Merge Join  (cost=5.60..12.51 rows=100 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..51.77 rows=997 width=4)
                                 Filter: ((c1 <> $1) AND (c1 <> $3) AND (c1 <> $5))
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(57 rows)

/*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
  AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
) AND bmt1.c1 <> (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
;
LOG:  statement: /*+
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(bmt1 bmt2)HashJoin(bmt1 bmt2 bmt3)NestLoop(bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(bmt1 bmt2 #1)Rows(bmt1 bmt2 bmt3 #1)Rows(bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
  AND bmt1.c1 <> (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
) AND bmt1.c1 <> (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
) AND bmt1.c1 <> (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(bmt1 bmt2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(bmt1 bmt2 bmt3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 bmt2 bmt3 bmt4)
Leading(bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(b3t1 b3t4 #1)
Rows(bmt1 bmt2 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t4 #1)
Rows(bmt1 bmt2 bmt3 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t3 b3t4 #1)
Rows(bmt1 bmt2 bmt3 bmt4 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=418.25..418.26 rows=1 width=4)
   InitPlan 1 (returns $1)
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   InitPlan 3 (returns $5)
     ->  Aggregate  (cost=124.17..124.18 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..124.17 rows=1 width=4)
                 ->  Hash Join  (cost=3.68..123.96 rows=1 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=12.68..38.29 rows=1 width=4)
         ->  Hash Join  (cost=12.52..38.07 rows=1 width=12)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=12.51..12.51 rows=1 width=8)
                     ->  Merge Join  (cost=5.60..12.51 rows=1 width=8)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..51.77 rows=997 width=4)
                                 Filter: ((c1 <> $1) AND (c1 <> $3) AND (c1 <> $5))
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(57 rows)

-- No. R-2-1-7
/*+
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(c2 c1)HashJoin(c2 c1 bmt1)NestLoop(c2 c1 bmt1 bmt2)MergeJoin(c2 c1 bmt1 bmt2 bmt3)HashJoin(c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
;
LOG:  statement: /*+
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(c2 c1)HashJoin(c2 c1 bmt1)NestLoop(c2 c1 bmt1 bmt2)MergeJoin(c2 c1 bmt1 bmt2 bmt3)HashJoin(c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(c1 c2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 c1 c2)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 c1 c2)
MergeJoin(bmt1 bmt2 bmt3 c1 c2)
HashJoin(bmt1 bmt2 bmt3 bmt4 c1 c2)
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=585.60..585.61 rows=1 width=4)
   CTE c1
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   CTE c2
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Hash Join  (cost=84.00..109.55 rows=1 width=4)
         Hash Cond: (bmt4.c1 = bmt1.c1)
         ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
         ->  Hash  (cost=83.99..83.99 rows=1 width=20)
               ->  Merge Join  (cost=20.19..83.99 rows=1 width=20)
                     Merge Cond: (bmt3.c1 = bmt1.c1)
                     ->  Index Only Scan using t3_i1 on t3 bmt3  (cost=0.15..61.10 rows=1130 width=4)
                     ->  Sort  (cost=20.04..20.05 rows=1 width=16)
                           Sort Key: bmt1.c1
                           ->  Nested Loop  (cost=0.24..20.03 rows=1 width=16)
                                 ->  Hash Join  (cost=0.10..19.86 rows=1 width=12)
                                       Hash Cond: (bmt1.c1 = c1.c1)
                                       ->  Seq Scan on t1 bmt1  (cost=0.00..16.00 rows=1000 width=4)
                                       ->  Hash  (cost=0.09..0.09 rows=1 width=8)
                                             ->  Merge Join  (cost=0.06..0.09 rows=1 width=8)
                                                   Merge Cond: (c1.c1 = c2.c1)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c1.c1
                                                         ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c2.c1
                                                         ->  CTE Scan on c2  (cost=0.00..0.02 rows=1 width=4)
                                 ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                                       Index Cond: (c1 = bmt1.c1)
(54 rows)

/*+
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(c2 c1)HashJoin(c2 c1 bmt1)NestLoop(c2 c1 bmt1 bmt2)MergeJoin(c2 c1 bmt1 bmt2 bmt3)HashJoin(c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(c2 c1 #1)Rows(c2 c1 bmt1 #1)Rows(c2 c1 bmt1 bmt2 #1)Rows(c2 c1 bmt1 bmt2 bmt3 #1)Rows(c2 c1 bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1;
LOG:  statement: /*+
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
MergeJoin(c2 c1)HashJoin(c2 c1 bmt1)NestLoop(c2 c1 bmt1 bmt2)MergeJoin(c2 c1 bmt1 bmt2 bmt3)HashJoin(c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
Rows(c2 c1 #1)Rows(c2 c1 bmt1 #1)Rows(c2 c1 bmt1 bmt2 #1)Rows(c2 c1 bmt1 bmt2 bmt3 #1)Rows(c2 c1 bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(c1 c2)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(bmt1 c1 c2)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(bmt1 bmt2 c1 c2)
MergeJoin(bmt1 bmt2 bmt3 c1 c2)
HashJoin(bmt1 bmt2 bmt3 bmt4 c1 c2)
Leading(c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(c1 c2 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(bmt1 c1 c2 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(bmt1 bmt2 c1 c2 #1)
Rows(bmt1 bmt2 bmt3 c1 c2 #1)
Rows(bmt1 bmt2 bmt3 bmt4 c1 c2 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=365.33..365.34 rows=1 width=4)
   CTE c1
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   CTE c2
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   ->  Hash Join  (cost=84.00..109.55 rows=1 width=4)
         Hash Cond: (bmt4.c1 = bmt1.c1)
         ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
         ->  Hash  (cost=83.99..83.99 rows=1 width=20)
               ->  Merge Join  (cost=20.19..83.99 rows=1 width=20)
                     Merge Cond: (bmt3.c1 = bmt1.c1)
                     ->  Index Only Scan using t3_i1 on t3 bmt3  (cost=0.15..61.10 rows=1130 width=4)
                     ->  Sort  (cost=20.04..20.05 rows=1 width=16)
                           Sort Key: bmt1.c1
                           ->  Nested Loop  (cost=0.24..20.03 rows=1 width=16)
                                 ->  Hash Join  (cost=0.10..19.86 rows=1 width=12)
                                       Hash Cond: (bmt1.c1 = c1.c1)
                                       ->  Seq Scan on t1 bmt1  (cost=0.00..16.00 rows=1000 width=4)
                                       ->  Hash  (cost=0.09..0.09 rows=1 width=8)
                                             ->  Merge Join  (cost=0.06..0.09 rows=1 width=8)
                                                   Merge Cond: (c1.c1 = c2.c1)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c1.c1
                                                         ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c2.c1
                                                         ->  CTE Scan on c2  (cost=0.00..0.02 rows=1 width=4)
                                 ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                                       Index Cond: (c1 = bmt1.c1)
(54 rows)

-- No. R-2-1-8
/*+
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(c3 c2)HashJoin(c3 c2 c1)NestLoop(c3 c2 c1 bmt1)MergeJoin(c3 c2 c1 bmt1 bmt2)HashJoin(c3 c2 c1 bmt1 bmt2 bmt3)NestLoop(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
, c3 (c1) AS (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2, c3
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
AND bmt1.c1 = c3.c1;
LOG:  statement: /*+
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(c3 c2)HashJoin(c3 c2 c1)NestLoop(c3 c2 c1 bmt1)MergeJoin(c3 c2 c1 bmt1 bmt2)HashJoin(c3 c2 c1 bmt1 bmt2 bmt3)NestLoop(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
, c3 (c1) AS (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2, c3
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
AND bmt1.c1 = c3.c1;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(c2 c3)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(c1 c2 c3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 c1 c2 c3)
MergeJoin(bmt1 bmt2 c1 c2 c3)
HashJoin(bmt1 bmt2 bmt3 c1 c2 c3)
NestLoop(bmt1 bmt2 bmt3 bmt4 c1 c2 c3)
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=664.37..664.38 rows=1 width=4)
   CTE c1
     ->  Aggregate  (cost=133.18..133.19 rows=1 width=4)
           ->  Nested Loop  (cost=72.27..132.93 rows=100 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   CTE c2
     ->  Aggregate  (cost=342.85..342.86 rows=1 width=4)
           ->  Nested Loop  (cost=28.95..342.60 rows=100 width=4)
                 ->  Hash Join  (cost=28.80..170.63 rows=1000 width=12)
                       Hash Cond: (b2t3.c1 = b2t1.c1)
                       ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                             Merge Cond: (b2t3.c1 = b2t4.c1)
                             ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=16.00..16.00 rows=1000 width=4)
                             ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   CTE c3
     ->  Aggregate  (cost=148.24..148.25 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..147.99 rows=100 width=4)
                 ->  Hash Join  (cost=3.68..126.59 rows=100 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=14.45..40.06 rows=1 width=4)
         ->  Hash Join  (cost=14.30..39.85 rows=1 width=24)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=14.29..14.29 rows=1 width=20)
                     ->  Merge Join  (cost=13.77..14.29 rows=1 width=20)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Sort  (cost=8.45..8.45 rows=1 width=16)
                                 Sort Key: bmt1.c1
                                 ->  Nested Loop  (cost=0.37..8.44 rows=1 width=16)
                                       Join Filter: (c1.c1 = bmt1.c1)
                                       ->  Hash Join  (cost=0.09..0.13 rows=1 width=12)
                                             Hash Cond: (c2.c1 = c1.c1)
                                             ->  Merge Join  (cost=0.06..0.09 rows=1 width=8)
                                                   Merge Cond: (c2.c1 = c3.c1)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c2.c1
                                                         ->  CTE Scan on c2  (cost=0.00..0.02 rows=1 width=4)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c3.c1
                                                         ->  CTE Scan on c3  (cost=0.00..0.02 rows=1 width=4)
                                             ->  Hash  (cost=0.02..0.02 rows=1 width=4)
                                                   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
                                       ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..8.29 rows=1 width=4)
                                             Index Cond: (c1 = c2.c1)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(73 rows)

/*+
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(c3 c2)HashJoin(c3 c2 c1)NestLoop(c3 c2 c1 bmt1)MergeJoin(c3 c2 c1 bmt1 bmt2)HashJoin(c3 c2 c1 bmt1 bmt2 bmt3)NestLoop(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(c3 c2 #1)Rows(c3 c2 c1 #1)Rows(c3 c2 c1 bmt1 #1)Rows(c3 c2 c1 bmt1 bmt2 #1)Rows(c3 c2 c1 bmt1 bmt2 bmt3 #1)Rows(c3 c2 c1 bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
, c3 (c1) AS (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2, c3
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
AND bmt1.c1 = c3.c1;
LOG:  statement: /*+
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
MergeJoin(c3 c2)HashJoin(c3 c2 c1)NestLoop(c3 c2 c1 bmt1)MergeJoin(c3 c2 c1 bmt1 bmt2)HashJoin(c3 c2 c1 bmt1 bmt2 bmt3)NestLoop(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
MergeJoin(b1t2 b1t3)HashJoin(b1t2 b1t3 b1t4)NestLoop(b1t2 b1t3 b1t4 b1t1)
MergeJoin(b2t3 b2t4)HashJoin(b2t3 b2t4 b2t1)NestLoop(b2t3 b2t4 b2t1 b2t2)
MergeJoin(b3t4 b3t1)HashJoin(b3t4 b3t1 b3t2)NestLoop(b3t1 b3t2 b3t3 b3t4)
Rows(c3 c2 #1)Rows(c3 c2 c1 #1)Rows(c3 c2 c1 bmt1 #1)Rows(c3 c2 c1 bmt1 bmt2 #1)Rows(c3 c2 c1 bmt1 bmt2 bmt3 #1)Rows(c3 c2 c1 bmt1 bmt2 bmt3 bmt4 #1)
Rows(b1t2 b1t3 #1)Rows(b1t2 b1t3 b1t4 #1)Rows(b1t2 b1t3 b1t4 b1t1 #1)
Rows(b2t3 b2t4 #1)Rows(b2t3 b2t4 b2t1 #1)Rows(b2t3 b2t4 b2t1 b2t2 #1)
Rows(b3t4 b3t1 #1)Rows(b3t4 b3t1 b3t2 #1)Rows(b3t1 b3t2 b3t3 b3t4 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT max(b1t1.c1) FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
, c2 (c1) AS (
SELECT max(b2t1.c1) FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
, c3 (c1) AS (
SELECT max(b3t1.c1) FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
)
SELECT max(bmt1.c1) FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4
, c1, c2, c3
                                                                        WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 = c2.c1
AND bmt1.c1 = c3.c1;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t2 b1t3)
MergeJoin(b2t3 b2t4)
MergeJoin(b3t1 b3t4)
MergeJoin(c2 c3)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(b2t1 b2t3 b2t4)
HashJoin(b3t1 b3t2 b3t4)
HashJoin(c1 c2 c3)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(b2t1 b2t2 b2t3 b2t4)
NestLoop(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt1 c1 c2 c3)
MergeJoin(bmt1 bmt2 c1 c2 c3)
HashJoin(bmt1 bmt2 bmt3 c1 c2 c3)
NestLoop(bmt1 bmt2 bmt3 bmt4 c1 c2 c3)
Leading(c3 c2 c1 bmt1 bmt2 bmt3 bmt4)
Leading(b1t2 b1t3 b1t4 b1t1)
Leading(b2t3 b2t4 b2t1 b2t2)
Leading(b3t4 b3t1 b3t2 b3t3)
Rows(b1t2 b1t3 #1)
Rows(b2t3 b2t4 #1)
Rows(b3t1 b3t4 #1)
Rows(c2 c3 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t4 #1)
Rows(c1 c2 c3 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t3 b3t4 #1)
Rows(bmt1 c1 c2 c3 #1)
Rows(bmt1 bmt2 c1 c2 c3 #1)
Rows(bmt1 bmt2 bmt3 c1 c2 c3 #1)
Rows(bmt1 bmt2 bmt3 bmt4 c1 c2 c3 #1)
not used hint:
duplication hint:
error hint:

                                                     QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=420.02..420.03 rows=1 width=4)
   CTE c1
     ->  Aggregate  (cost=96.66..96.67 rows=1 width=4)
           ->  Nested Loop  (cost=71.04..96.65 rows=1 width=4)
                 Join Filter: (b1t2.c1 = b1t1.c1)
                 ->  Hash Join  (cost=70.76..96.31 rows=1 width=12)
                       Hash Cond: (b1t4.c1 = b1t2.c1)
                       ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Hash  (cost=70.75..70.75 rows=1 width=8)
                             ->  Merge Join  (cost=5.47..70.75 rows=1 width=8)
                                   Merge Cond: (b1t3.c1 = b1t2.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                         Sort Key: b1t2.c1
                                         ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                       Index Cond: (c1 = b1t3.c1)
   CTE c2
     ->  Aggregate  (cost=159.10..159.11 rows=1 width=4)
           ->  Nested Loop  (cost=139.31..159.10 rows=1 width=4)
                 ->  Hash Join  (cost=139.17..158.93 rows=1 width=12)
                       Hash Cond: (b2t1.c1 = b2t3.c1)
                       ->  Seq Scan on t1 b2t1  (cost=0.00..16.00 rows=1000 width=4)
                       ->  Hash  (cost=139.16..139.16 rows=1 width=8)
                             ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                                   Merge Cond: (b2t3.c1 = b2t4.c1)
                                   ->  Index Only Scan using t3_i1 on t3 b2t3  (cost=0.15..61.10 rows=1130 width=4)
                                   ->  Index Only Scan using t4_i1 on t4 b2t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                       Index Cond: (c1 = b2t1.c1)
   CTE c3
     ->  Aggregate  (cost=124.17..124.18 rows=1 width=4)
           ->  Nested Loop  (cost=3.83..124.17 rows=1 width=4)
                 ->  Hash Join  (cost=3.68..123.96 rows=1 width=12)
                       Hash Cond: (b3t1.c1 = b3t2.c1)
                       ->  Merge Join  (cost=0.43..120.70 rows=1 width=8)
                             Merge Cond: (b3t1.c1 = b3t4.c1)
                             ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
                             ->  Index Only Scan using t4_i1 on t4 b3t4  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                             ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
                 ->  Index Only Scan using t3_i1 on t3 b3t3  (cost=0.15..0.21 rows=1 width=4)
                       Index Cond: (c1 = b3t1.c1)
   ->  Nested Loop  (cost=14.45..40.06 rows=1 width=4)
         ->  Hash Join  (cost=14.30..39.85 rows=1 width=24)
               Hash Cond: (bmt3.c1 = bmt1.c1)
               ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=14.29..14.29 rows=1 width=20)
                     ->  Merge Join  (cost=13.77..14.29 rows=1 width=20)
                           Merge Cond: (bmt1.c1 = bmt2.c1)
                           ->  Sort  (cost=8.45..8.45 rows=1 width=16)
                                 Sort Key: bmt1.c1
                                 ->  Nested Loop  (cost=0.37..8.44 rows=1 width=16)
                                       Join Filter: (c1.c1 = bmt1.c1)
                                       ->  Hash Join  (cost=0.09..0.13 rows=1 width=12)
                                             Hash Cond: (c2.c1 = c1.c1)
                                             ->  Merge Join  (cost=0.06..0.09 rows=1 width=8)
                                                   Merge Cond: (c2.c1 = c3.c1)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c2.c1
                                                         ->  CTE Scan on c2  (cost=0.00..0.02 rows=1 width=4)
                                                   ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                                         Sort Key: c3.c1
                                                         ->  CTE Scan on c3  (cost=0.00..0.02 rows=1 width=4)
                                             ->  Hash  (cost=0.02..0.02 rows=1 width=4)
                                                   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
                                       ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..8.29 rows=1 width=4)
                                             Index Cond: (c1 = c2.c1)
                           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                 Sort Key: bmt2.c1
                                 ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(73 rows)

----
---- No. R-2-2 the number of the tables per quiry block
----
-- No. R-2-2-1
/*+
Leading(c1 bmt1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1 WHERE b1t1.c1 = 1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, c1 WHERE bmt1.c1 = 1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1 WHERE b3t1.c1 = 1
);
LOG:  statement: /*+
Leading(c1 bmt1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1 WHERE b1t1.c1 = 1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, c1 WHERE bmt1.c1 = 1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1 WHERE b3t1.c1 = 1
);
LOG:  pg_hint_plan:
used hint:
Leading(c1 bmt1)
not used hint:
duplication hint:
error hint:

                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Nested Loop  (cost=25.15..33.20 rows=1 width=8)
   CTE c1
     ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 2 (returns $1)
     ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 3 (returns $2)
     ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..8.29 rows=1 width=4)
         Index Cond: (c1 = 1)
         Filter: (c1 <> $2)
   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
         Filter: (c1 = 1)
(15 rows)

/*+
Leading(c1 bmt1)
Rows(bmt1 c1 #1)
Rows(b1t1 c1 #1)
Rows(b2t1 c1 #1)
Rows(b3t1 c1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1 WHERE b1t1.c1 = 1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, c1 WHERE bmt1.c1 = 1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1 WHERE b3t1.c1 = 1
);
LOG:  statement: /*+
Leading(c1 bmt1)
Rows(bmt1 c1 #1)
Rows(b1t1 c1 #1)
Rows(b2t1 c1 #1)
Rows(b3t1 c1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1 WHERE b1t1.c1 = 1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, c1 WHERE bmt1.c1 = 1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1 WHERE b3t1.c1 = 1
);
LOG:  pg_hint_plan:
used hint:
Leading(c1 bmt1)
Rows(bmt1 c1 #1)
not used hint:
Rows(b1t1 c1 #1)
Rows(b2t1 c1 #1)
Rows(b3t1 c1 #1)
duplication hint:
error hint:

                                    QUERY PLAN                                    
----------------------------------------------------------------------------------
 Nested Loop  (cost=25.15..33.20 rows=1 width=8)
   CTE c1
     ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 2 (returns $1)
     ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 3 (returns $2)
     ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..8.29 rows=1 width=4)
         Index Cond: (c1 = 1)
         Filter: (c1 <> $2)
   ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
         Filter: (c1 = 1)
(15 rows)

-- No. R-2-2-2
/*+
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
MergeJoin(c1 bmt2)
HashJoin(c1 bmt1 bmt2)
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2 WHERE b1t1.c1 = b1t2.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2 WHERE b2t1.c1 = b2t2.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, c1 WHERE bmt1.c1 = bmt2.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2 WHERE b3t1.c1 = b3t2.c1
);
LOG:  statement: /*+
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
MergeJoin(c1 bmt2)
HashJoin(c1 bmt1 bmt2)
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2 WHERE b1t1.c1 = b1t2.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2 WHERE b2t1.c1 = b2t2.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, c1 WHERE bmt1.c1 = bmt2.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2 WHERE b3t1.c1 = b3t2.c1
);
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
MergeJoin(bmt2 c1)
HashJoin(bmt1 bmt2 c1)
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
not used hint:
duplication hint:
error hint:

                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Hash Join  (cost=49.13..72.38 rows=10 width=8)
   Hash Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
           Merge Cond: (b1t1.c1 = b1t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b1t2.c1
                 ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
   InitPlan 2 (returns $1)
     ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
           Merge Cond: (b2t1.c1 = b2t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b2t2.c1
                 ->  Seq Scan on t2 b2t2  (cost=0.00..2.00 rows=100 width=4)
   InitPlan 3 (returns $2)
     ->  Merge Join  (cost=5.60..11.75 rows=100 width=4)
           Merge Cond: (b3t1.c1 = b3t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b3t2.c1
                 ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
   ->  Seq Scan on t1 bmt1  (cost=0.00..18.50 rows=999 width=4)
         Filter: (c1 <> $2)
   ->  Hash  (cost=12.64..12.64 rows=100 width=8)
         ->  Merge Join  (cost=10.64..12.64 rows=100 width=8)
               Merge Cond: (bmt2.c1 = c1.c1)
               ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                     Sort Key: bmt2.c1
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
               ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                     Sort Key: c1.c1
                     ->  CTE Scan on c1  (cost=0.00..2.00 rows=100 width=4)
(34 rows)

/*+
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
MergeJoin(c1 bmt2)
HashJoin(c1 bmt1 bmt2)
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
Rows(c1 bmt2 #1)
Rows(c1 bmt1 bmt2 #1)
Rows(b1t1 b1t2 #1)
Rows(b2t1 b2t2 #1)
Rows(b3t1 b3t2 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2 WHERE b1t1.c1 = b1t2.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2 WHERE b2t1.c1 = b2t2.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, c1 WHERE bmt1.c1 = bmt2.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2 WHERE b3t1.c1 = b3t2.c1
)
;
LOG:  statement: /*+
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
MergeJoin(c1 bmt2)
HashJoin(c1 bmt1 bmt2)
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
Rows(c1 bmt2 #1)
Rows(c1 bmt1 bmt2 #1)
Rows(b1t1 b1t2 #1)
Rows(b2t1 b2t2 #1)
Rows(b3t1 b3t2 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2 WHERE b1t1.c1 = b1t2.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2 WHERE b2t1.c1 = b2t2.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, c1 WHERE bmt1.c1 = bmt2.c1
AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2 WHERE b3t1.c1 = b3t2.c1
)
;
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t1 b1t2)
MergeJoin(b2t1 b2t2)
MergeJoin(b3t1 b3t2)
MergeJoin(bmt2 c1)
HashJoin(bmt1 bmt2 c1)
Leading(c1 bmt2 bmt1)
Leading(b1t2 b1t1)
Leading(b2t2 b2t1)
Leading(b3t2 b3t1)
Rows(b1t1 b1t2 #1)
Rows(b2t1 b2t2 #1)
Rows(b3t1 b3t2 #1)
Rows(bmt2 c1 #1)
Rows(bmt1 bmt2 c1 #1)
not used hint:
duplication hint:
error hint:

                                         QUERY PLAN                                         
--------------------------------------------------------------------------------------------
 Hash Join  (cost=41.12..63.38 rows=1 width=8)
   Hash Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
           Merge Cond: (b1t1.c1 = b1t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b1t2.c1
                 ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
   InitPlan 2 (returns $1)
     ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
           Merge Cond: (b2t1.c1 = b2t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b2t2.c1
                 ->  Seq Scan on t2 b2t2  (cost=0.00..2.00 rows=100 width=4)
   InitPlan 3 (returns $2)
     ->  Merge Join  (cost=5.60..11.75 rows=1 width=4)
           Merge Cond: (b3t1.c1 = b3t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                 Sort Key: b3t2.c1
                 ->  Seq Scan on t2 b3t2  (cost=0.00..2.00 rows=100 width=4)
   ->  Seq Scan on t1 bmt1  (cost=0.00..18.50 rows=999 width=4)
         Filter: (c1 <> $2)
   ->  Hash  (cost=5.87..5.87 rows=1 width=8)
         ->  Merge Join  (cost=5.35..5.87 rows=1 width=8)
               Merge Cond: (bmt2.c1 = c1.c1)
               ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                     Sort Key: bmt2.c1
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
               ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                     Sort Key: c1.c1
                     ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
(34 rows)

-- No. R-2-2-3
/*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1) 
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
HashJoin(b1t4 b1t3)
NestLoop(b1t4 b1t3 b1t2)
MergeJoin(b1t4 b1t3 b1t2 b1t1)
HashJoin(b2t4 b2t3)
NestLoop(b2t4 b2t3 b2t2)
MergeJoin(b2t4 b2t3 b2t2 b2t1)
HashJoin(b3t4 b3t3)
NestLoop(b3t4 b3t3 b3t2)
MergeJoin(b3t4 b3t3 b3t2 b3t1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
);
LOG:  statement: /*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1) 
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
HashJoin(b1t4 b1t3)
NestLoop(b1t4 b1t3 b1t2)
MergeJoin(b1t4 b1t3 b1t2 b1t1)
HashJoin(b2t4 b2t3)
NestLoop(b2t4 b2t3 b2t2)
MergeJoin(b2t4 b2t3 b2t2 b2t1)
HashJoin(b3t4 b3t3)
NestLoop(b3t4 b3t3 b3t2)
MergeJoin(b3t4 b3t3 b3t2 b3t1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
);
LOG:  pg_hint_plan:
used hint:
HashJoin(b1t3 b1t4)
HashJoin(b2t3 b2t4)
HashJoin(b3t3 b3t4)
MergeJoin(bmt4 c1)
NestLoop(b1t2 b1t3 b1t4)
NestLoop(b2t2 b2t3 b2t4)
NestLoop(b3t2 b3t3 b3t4)
HashJoin(bmt3 bmt4 c1)
MergeJoin(b1t1 b1t2 b1t3 b1t4)
MergeJoin(b2t1 b2t2 b2t3 b2t4)
MergeJoin(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt2 bmt3 bmt4 c1)
MergeJoin(bmt1 bmt2 bmt3 bmt4 c1)
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
not used hint:
duplication hint:
error hint:

                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=905.86..912.27 rows=10 width=8)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Merge Join  (cost=256.07..262.22 rows=100 width=4)
           Merge Cond: (b1t1.c1 = b1t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=255.80..256.05 rows=100 width=12)
                 Sort Key: b1t2.c1
                 ->  Nested Loop  (cost=35.57..252.48 rows=100 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                             Hash Cond: (b1t3.c1 = b1t4.c1)
                             ->  Seq Scan on t3 b1t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b1t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Merge Join  (cost=256.07..262.22 rows=100 width=4)
           Merge Cond: (b2t1.c1 = b2t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=255.80..256.05 rows=100 width=12)
                 Sort Key: b2t2.c1
                 ->  Nested Loop  (cost=35.57..252.48 rows=100 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                             Hash Cond: (b2t3.c1 = b2t4.c1)
                             ->  Seq Scan on t3 b2t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b2t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b2t3.c1)
   InitPlan 3 (returns $5)
     ->  Merge Join  (cost=256.07..262.22 rows=100 width=4)
           Merge Cond: (b3t1.c1 = b3t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=255.80..256.05 rows=100 width=12)
                 Sort Key: b3t2.c1
                 ->  Nested Loop  (cost=35.57..252.48 rows=100 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                             Hash Cond: (b3t3.c1 = b3t4.c1)
                             ->  Seq Scan on t3 b3t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b3t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b3t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b3t3.c1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..46.77 rows=999 width=4)
         Filter: (c1 <> $5)
   ->  Sort  (cost=118.92..119.17 rows=100 width=16)
         Sort Key: bmt2.c1
         ->  Nested Loop  (cost=72.14..115.60 rows=100 width=16)
               ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                           ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                 Merge Cond: (bmt4.c1 = c1.c1)
                                 ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..61.10 rows=1130 width=4)
                                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                       Sort Key: c1.c1
                                       ->  CTE Scan on c1  (cost=0.00..2.00 rows=100 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
(61 rows)

/*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1) 
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
HashJoin(b1t4 b1t3)
NestLoop(b1t4 b1t3 b1t2)
MergeJoin(b1t4 b1t3 b1t2 b1t1)
HashJoin(b2t4 b2t3)
NestLoop(b2t4 b2t3 b2t2)
MergeJoin(b2t4 b2t3 b2t2 b2t1)
HashJoin(b3t4 b3t3)
NestLoop(b3t4 b3t3 b3t2)
MergeJoin(b3t4 b3t3 b3t2 b3t1)
Rows(c1 bmt4 #1)
Rows(c1 bmt4 bmt3 #1)
Rows(c1 bmt4 bmt3 bmt2 #1)
Rows(c1 bmt4 bmt3 bmt2 bmt1 #1)
Rows(b1t4 b1t3 #1)
Rows(b1t4 b1t3 b1t2 #1)
Rows(b1t4 b1t3 b1t2 b1t1 #1)
Rows(b2t4 b2t3 #1)
Rows(b2t4 b2t3 b2t2 #1)
Rows(b2t4 b2t3 b2t2 b2t1 #1)
Rows(b3t4 b3t3 #1)
Rows(b3t4 b3t3 b3t2 #1)
Rows(b3t4 b3t3 b3t2 b3t1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
);
LOG:  statement: /*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1) 
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
HashJoin(b1t4 b1t3)
NestLoop(b1t4 b1t3 b1t2)
MergeJoin(b1t4 b1t3 b1t2 b1t1)
HashJoin(b2t4 b2t3)
NestLoop(b2t4 b2t3 b2t2)
MergeJoin(b2t4 b2t3 b2t2 b2t1)
HashJoin(b3t4 b3t3)
NestLoop(b3t4 b3t3 b3t2)
MergeJoin(b3t4 b3t3 b3t2 b3t1)
Rows(c1 bmt4 #1)
Rows(c1 bmt4 bmt3 #1)
Rows(c1 bmt4 bmt3 bmt2 #1)
Rows(c1 bmt4 bmt3 bmt2 bmt1 #1)
Rows(b1t4 b1t3 #1)
Rows(b1t4 b1t3 b1t2 #1)
Rows(b1t4 b1t3 b1t2 b1t1 #1)
Rows(b2t4 b2t3 #1)
Rows(b2t4 b2t3 b2t2 #1)
Rows(b2t4 b2t3 b2t2 b2t1 #1)
Rows(b3t4 b3t3 #1)
Rows(b3t4 b3t3 b3t2 #1)
Rows(b3t4 b3t3 b3t2 b3t1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1, s1.t2 b2t2, s1.t3 b2t3, s1.t4 b2t4 WHERE b2t1.c1 = b2t2.c1 AND b2t1.c1 = b2t3.c1 AND b2t1.c1 = b2t4.c1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1, s1.t2 b3t2, s1.t3 b3t3, s1.t4 b3t4 WHERE b3t1.c1 = b3t2.c1 AND b3t1.c1 = b3t3.c1 AND b3t1.c1 = b3t4.c1
);
LOG:  pg_hint_plan:
used hint:
HashJoin(b1t3 b1t4)
HashJoin(b2t3 b2t4)
HashJoin(b3t3 b3t4)
MergeJoin(bmt4 c1)
NestLoop(b1t2 b1t3 b1t4)
NestLoop(b2t2 b2t3 b2t4)
NestLoop(b3t2 b3t3 b3t4)
HashJoin(bmt3 bmt4 c1)
MergeJoin(b1t1 b1t2 b1t3 b1t4)
MergeJoin(b2t1 b2t2 b2t3 b2t4)
MergeJoin(b3t1 b3t2 b3t3 b3t4)
NestLoop(bmt2 bmt3 bmt4 c1)
MergeJoin(bmt1 bmt2 bmt3 bmt4 c1)
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
Leading(b2t4 b2t3 b2t2 b2t1)
Leading(b3t4 b3t3 b3t2 b3t1)
Rows(b1t3 b1t4 #1)
Rows(b2t3 b2t4 #1)
Rows(b3t3 b3t4 #1)
Rows(bmt4 c1 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(b2t2 b2t3 b2t4 #1)
Rows(b3t2 b3t3 b3t4 #1)
Rows(bmt3 bmt4 c1 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(b2t1 b2t2 b2t3 b2t4 #1)
Rows(b3t1 b3t2 b3t3 b3t4 #1)
Rows(bmt2 bmt3 bmt4 c1 #1)
Rows(bmt1 bmt2 bmt3 bmt4 c1 #1)
not used hint:
duplication hint:
error hint:

                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=284.47..289.39 rows=1 width=8)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Merge Join  (cost=60.16..64.83 rows=1 width=4)
           Merge Cond: (b1t1.c1 = b1t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=59.88..59.89 rows=1 width=12)
                 Sort Key: b1t2.c1
                 ->  Nested Loop  (cost=35.57..59.87 rows=1 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1 width=8)
                             Hash Cond: (b1t3.c1 = b1t4.c1)
                             ->  Seq Scan on t3 b1t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b1t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b1t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $3)
     ->  Merge Join  (cost=60.16..64.83 rows=1 width=4)
           Merge Cond: (b2t1.c1 = b2t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=59.88..59.89 rows=1 width=12)
                 Sort Key: b2t2.c1
                 ->  Nested Loop  (cost=35.57..59.87 rows=1 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1 width=8)
                             Hash Cond: (b2t3.c1 = b2t4.c1)
                             ->  Seq Scan on t3 b2t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b2t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b2t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b2t3.c1)
   InitPlan 3 (returns $5)
     ->  Merge Join  (cost=60.16..64.83 rows=1 width=4)
           Merge Cond: (b3t1.c1 = b3t2.c1)
           ->  Index Only Scan using t1_i1 on t1 b3t1  (cost=0.28..44.27 rows=1000 width=4)
           ->  Sort  (cost=59.88..59.89 rows=1 width=12)
                 Sort Key: b3t2.c1
                 ->  Nested Loop  (cost=35.57..59.87 rows=1 width=12)
                       ->  Hash Join  (cost=35.43..59.70 rows=1 width=8)
                             Hash Cond: (b3t3.c1 = b3t4.c1)
                             ->  Seq Scan on t3 b3t3  (cost=0.00..21.30 rows=1130 width=4)
                             ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                                   ->  Seq Scan on t4 b3t4  (cost=0.00..21.30 rows=1130 width=4)
                       ->  Index Only Scan using t2_i1 on t2 b3t2  (cost=0.14..0.17 rows=1 width=4)
                             Index Cond: (c1 = b3t3.c1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..46.77 rows=999 width=4)
         Filter: (c1 <> $5)
   ->  Sort  (cost=89.72..89.72 rows=1 width=16)
         Sort Key: bmt2.c1
         ->  Nested Loop  (cost=64.13..89.71 rows=1 width=16)
               ->  Hash Join  (cost=63.99..89.53 rows=1 width=12)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=63.97..63.97 rows=1 width=8)
                           ->  Merge Join  (cost=0.18..63.97 rows=1 width=8)
                                 Merge Cond: (bmt4.c1 = c1.c1)
                                 ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..61.10 rows=1130 width=4)
                                 ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                       Sort Key: c1.c1
                                       ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
(61 rows)

-- No. R-2-2-4
/*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
MergeJoin(b1t4 b1t3)
HashJoin(b1t4 b1t3 b1t2)
NestLoop(b1t4 b1t3 b1t2 b1t1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1
);
LOG:  statement: /*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
MergeJoin(b1t4 b1t3)
HashJoin(b1t4 b1t3 b1t2)
NestLoop(b1t4 b1t3 b1t2 b1t1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1
);
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t3 b1t4)
MergeJoin(bmt4 c1)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(bmt3 bmt4 c1)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(bmt2 bmt3 bmt4 c1)
MergeJoin(bmt1 bmt2 bmt3 bmt4 c1)
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
not used hint:
duplication hint:
error hint:

                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=323.27..329.67 rows=10 width=8)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Nested Loop  (cost=3.83..179.78 rows=100 width=4)
           Join Filter: (b1t2.c1 = b1t1.c1)
           ->  Hash Join  (cost=3.56..145.38 rows=100 width=12)
                 Hash Cond: (b1t3.c1 = b1t2.c1)
                 ->  Merge Join  (cost=0.30..139.16 rows=1130 width=8)
                       Merge Cond: (b1t3.c1 = b1t4.c1)
                       ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Index Only Scan using t4_i1 on t4 b1t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                       ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                 Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $2)
     ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 3 (returns $3)
     ->  Seq Scan on t1 b3t1  (cost=0.00..16.00 rows=1000 width=4)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..46.77 rows=999 width=4)
         Filter: (c1 <> $3)
   ->  Sort  (cost=118.92..119.17 rows=100 width=16)
         Sort Key: bmt2.c1
         ->  Nested Loop  (cost=72.14..115.60 rows=100 width=16)
               ->  Hash Join  (cost=72.00..98.54 rows=100 width=12)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=70.75..70.75 rows=100 width=8)
                           ->  Merge Join  (cost=5.47..70.75 rows=100 width=8)
                                 Merge Cond: (bmt4.c1 = c1.c1)
                                 ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..61.10 rows=1130 width=4)
                                 ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                                       Sort Key: c1.c1
                                       ->  CTE Scan on c1  (cost=0.00..2.00 rows=100 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
(37 rows)

/*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
MergeJoin(b1t4 b1t3)
HashJoin(b1t4 b1t3 b1t2)
NestLoop(b1t4 b1t3 b1t2 b1t1)
Rows(c1 bmt4 #1)
Rows(c1 bmt4 bmt3 #1)
Rows(c1 bmt4 bmt3 bmt2 #1)
Rows(c1 bmt4 bmt3 bmt2 bmt1 #1)
Rows(b1t4 b1t3 #1)
Rows(b1t4 b1t3 b1t2 #1)
Rows(b1t4 b1t3 b1t2 b1t1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1
);
LOG:  statement: /*+
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
MergeJoin(c1 bmt4)
HashJoin(c1 bmt4 bmt3)
NestLoop(c1 bmt4 bmt3 bmt2)
MergeJoin(c1 bmt4 bmt3 bmt2 bmt1)
MergeJoin(b1t4 b1t3)
HashJoin(b1t4 b1t3 b1t2)
NestLoop(b1t4 b1t3 b1t2 b1t1)
Rows(c1 bmt4 #1)
Rows(c1 bmt4 bmt3 #1)
Rows(c1 bmt4 bmt3 bmt2 #1)
Rows(c1 bmt4 bmt3 bmt2 bmt1 #1)
Rows(b1t4 b1t3 #1)
Rows(b1t4 b1t3 b1t2 #1)
Rows(b1t4 b1t3 b1t2 b1t1 #1)
*/
EXPLAIN
WITH c1 (c1) AS (
SELECT b1t1.c1 FROM s1.t1 b1t1, s1.t2 b1t2, s1.t3 b1t3, s1.t4 b1t4 WHERE b1t1.c1 = b1t2.c1 AND b1t1.c1 = b1t3.c1 AND b1t1.c1 = b1t4.c1
)
SELECT bmt1.c1, (
SELECT b2t1.c1 FROM s1.t1 b2t1 WHERE b2t1.c1 = 1
)
                    FROM s1.t1 bmt1, s1.t2 bmt2, s1.t3 bmt3, s1.t4 bmt4, c1 WHERE bmt1.c1 = bmt2.c1 AND bmt1.c1 = bmt3.c1 AND bmt1.c1 = bmt4.c1 AND bmt1.c1 = c1.c1
AND bmt1.c1 <> (
SELECT b3t1.c1 FROM s1.t1 b3t1
);
LOG:  pg_hint_plan:
used hint:
MergeJoin(b1t3 b1t4)
MergeJoin(bmt4 c1)
HashJoin(b1t2 b1t3 b1t4)
HashJoin(bmt3 bmt4 c1)
NestLoop(b1t1 b1t2 b1t3 b1t4)
NestLoop(bmt2 bmt3 bmt4 c1)
MergeJoin(bmt1 bmt2 bmt3 bmt4 c1)
Leading(c1 bmt4 bmt3 bmt2 bmt1)
Leading(b1t4 b1t3 b1t2 b1t1)
Rows(b1t3 b1t4 #1)
Rows(bmt4 c1 #1)
Rows(b1t2 b1t3 b1t4 #1)
Rows(bmt3 bmt4 c1 #1)
Rows(b1t1 b1t2 b1t3 b1t4 #1)
Rows(bmt2 bmt3 bmt4 c1 #1)
Rows(bmt1 bmt2 bmt3 bmt4 c1 #1)
not used hint:
duplication hint:
error hint:

                                                    QUERY PLAN                                                    
------------------------------------------------------------------------------------------------------------------
 Merge Join  (cost=257.04..261.96 rows=1 width=8)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   CTE c1
     ->  Nested Loop  (cost=3.83..142.75 rows=1 width=4)
           Join Filter: (b1t2.c1 = b1t1.c1)
           ->  Hash Join  (cost=3.56..142.41 rows=1 width=12)
                 Hash Cond: (b1t3.c1 = b1t2.c1)
                 ->  Merge Join  (cost=0.30..139.16 rows=1 width=8)
                       Merge Cond: (b1t3.c1 = b1t4.c1)
                       ->  Index Only Scan using t3_i1 on t3 b1t3  (cost=0.15..61.10 rows=1130 width=4)
                       ->  Index Only Scan using t4_i1 on t4 b1t4  (cost=0.15..61.10 rows=1130 width=4)
                 ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                       ->  Seq Scan on t2 b1t2  (cost=0.00..2.00 rows=100 width=4)
           ->  Index Only Scan using t1_i1 on t1 b1t1  (cost=0.28..0.33 rows=1 width=4)
                 Index Cond: (c1 = b1t3.c1)
   InitPlan 2 (returns $2)
     ->  Index Only Scan using t1_i1 on t1 b2t1  (cost=0.28..8.29 rows=1 width=4)
           Index Cond: (c1 = 1)
   InitPlan 3 (returns $3)
     ->  Seq Scan on t1 b3t1  (cost=0.00..16.00 rows=1000 width=4)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..46.77 rows=999 width=4)
         Filter: (c1 <> $3)
   ->  Sort  (cost=89.72..89.72 rows=1 width=16)
         Sort Key: bmt2.c1
         ->  Nested Loop  (cost=64.13..89.71 rows=1 width=16)
               ->  Hash Join  (cost=63.99..89.53 rows=1 width=12)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=63.97..63.97 rows=1 width=8)
                           ->  Merge Join  (cost=0.18..63.97 rows=1 width=8)
                                 Merge Cond: (bmt4.c1 = c1.c1)
                                 ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..61.10 rows=1130 width=4)
                                 ->  Sort  (cost=0.03..0.04 rows=1 width=4)
                                       Sort Key: c1.c1
                                       ->  CTE Scan on c1  (cost=0.00..0.02 rows=1 width=4)
               ->  Index Only Scan using t2_i1 on t2 bmt2  (cost=0.14..0.17 rows=1 width=4)
                     Index Cond: (c1 = bmt3.c1)
(37 rows)

----
---- No. R-2-3 RULE or VIEW
----
-- No. R-2-3-1
/*+
Leading(r1 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r1 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r1 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r1 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r1 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r1  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(20 rows)

/*+
Leading(r1 t1 t2 t3 t4)
Rows(r1 t1 t2 t3 t4 #2)
Rows(r1 t1 t2 t3 #2)
Rows(r1 t1 t2 #2)
Rows(r1 t1 #2)
*/
EXPLAIN UPDATE s1.r1 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r1 t1 t2 t3 t4)
Rows(r1 t1 t2 t3 t4 #2)
Rows(r1 t1 t2 t3 #2)
Rows(r1 t1 t2 #2)
Rows(r1 t1 #2)
*/
EXPLAIN UPDATE s1.r1 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r1 t1 t2 t3 t4)
Rows(r1 t1 #2)
Rows(r1 t1 t2 #2)
Rows(r1 t1 t2 t3 #2)
Rows(r1 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r1  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(18 rows)

/*+
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
*/
EXPLAIN UPDATE s1.r1_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
*/
EXPLAIN UPDATE s1.r1_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
not used hint:
duplication hint:
error hint:

                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b1t1.c1 = b1t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b1t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r1_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b1t2.c1
                           ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(20 rows)

/*+
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
Rows(r1_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r1_ b1t1 b1t2 b1t3 #2)
Rows(r1_ b1t1 b1t2 #2)
Rows(r1_ b1t1 #2)
*/
EXPLAIN UPDATE s1.r1_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
Rows(r1_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r1_ b1t1 b1t2 b1t3 #2)
Rows(r1_ b1t1 b1t2 #2)
Rows(r1_ b1t1 #2)
*/
EXPLAIN UPDATE s1.r1_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r1_ b1t1 b1t2 b1t3 b1t4)
Rows(b1t1 r1_ #2)
Rows(b1t1 b1t2 r1_ #2)
Rows(b1t1 b1t2 b1t3 r1_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r1_ #2)
not used hint:
duplication hint:
error hint:

                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b1t1.c1 = b1t2.c1)
                     ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b1t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r1_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(18 rows)

-- No. R-2-3-2
/*+
Leading(r2 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r2 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r2 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r2 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r2 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r2 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(41 rows)

/*+
Leading(r2 t1 t2 t3 t4)
Rows(r2 t1 t2 t3 t4 #2)
Rows(r2 t1 t2 t3 #2)
Rows(r2 t1 t2 #2)
Rows(r2 t1 #2)
*/
EXPLAIN UPDATE s1.r2 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r2 t1 t2 t3 t4)
Rows(r2 t1 t2 t3 t4 #2)
Rows(r2 t1 t2 t3 #2)
Rows(r2 t1 t2 #2)
Rows(r2 t1 #2)
*/
EXPLAIN UPDATE s1.r2 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r2 t1 t2 t3 t4)
Rows(r2 t1 #2)
Rows(r2 t1 t2 #2)
Rows(r2 t1 t2 t3 #2)
Rows(r2 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r2 t1 t2 t3 t4)
Rows(r2 t1 #2)
Rows(r2 t1 t2 #2)
Rows(r2 t1 t2 t3 #2)
Rows(r2 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(37 rows)

/*+
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
*/
EXPLAIN UPDATE s1.r2_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
*/
EXPLAIN UPDATE s1.r2_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
not used hint:
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
not used hint:
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
duplication hint:
error hint:

                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b1t1.c1 = b1t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b1t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b1t2.c1
                           ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b2t1.c1 = b2t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b2t1.c1 = b2t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b2t1.c1 = b2t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b2t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b2t2.c1
                           ->  Seq Scan on t2 b2t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b2t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b2t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(41 rows)

/*+
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
Rows(r2_ b1t1 #2)
Rows(r2_ b1t1 b1t2 #2)
Rows(r2_ b1t1 b1t2 b1t3 #2)
Rows(r2_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r2_ b2t1 #2)
Rows(r2_ b2t1 b2t2 #2)
Rows(r2_ b2t1 b2t2 b2t3  #2)
Rows(r2_ b2t1 b2t2 b2t3 b2t4 #2)
*/
EXPLAIN UPDATE s1.r2_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
Rows(r2_ b1t1 #2)
Rows(r2_ b1t1 b1t2 #2)
Rows(r2_ b1t1 b1t2 b1t3 #2)
Rows(r2_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r2_ b2t1 #2)
Rows(r2_ b2t1 b2t2 #2)
Rows(r2_ b2t1 b2t2 b2t3  #2)
Rows(r2_ b2t1 b2t2 b2t3 b2t4 #2)
*/
EXPLAIN UPDATE s1.r2_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Rows(b1t1 r2_ #2)
Rows(b1t1 b1t2 r2_ #2)
Rows(b1t1 b1t2 b1t3 r2_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r2_ #2)
not used hint:
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
Rows(b2t1 r2_ #2)
Rows(b2t1 b2t2 r2_ #2)
Rows(b2t1 b2t2 b2t3 r2_ #2)
Rows(b2t1 b2t2 b2t3 b2t4 r2_ #2)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r2_ b2t1 b2t2 b2t3 b2t4)
Rows(b2t1 r2_ #2)
Rows(b2t1 b2t2 r2_ #2)
Rows(b2t1 b2t2 b2t3 r2_ #2)
Rows(b2t1 b2t2 b2t3 b2t4 r2_ #2)
not used hint:
Leading(r2_ b1t1 b1t2 b1t3 b1t4)
Rows(b1t1 r2_ #2)
Rows(b1t1 b1t2 r2_ #2)
Rows(b1t1 b1t2 b1t3 r2_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r2_ #2)
duplication hint:
error hint:

                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b1t1.c1 = b1t2.c1)
                     ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b1t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b2t1.c1 = b2t4.c1)
         ->  Tid Scan on t4 b2t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b2t1.c1 = b2t3.c1)
               ->  Tid Scan on t3 b2t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b2t1.c1 = b2t2.c1)
                     ->  Seq Scan on t2 b2t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b2t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r2_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(37 rows)

-- No. R-2-3-3
/*+
Leading(r3 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r3 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r3 t1 t2 t3 t4)
*/
EXPLAIN UPDATE s1.r3 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
not used hint:
duplication hint:
error hint:

                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (t1.c1 = t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: t2.c1
                           ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(62 rows)

/*+
Leading(r3 t1 t2 t3 t4)
Rows(r3 t1 t2 t3 t4 #2)
Rows(r3 t1 t2 t3 #2)
Rows(r3 t1 t2 #2)
Rows(r3 t1 #2)
*/
EXPLAIN UPDATE s1.r3 SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r3 t1 t2 t3 t4)
Rows(r3 t1 t2 t3 t4 #2)
Rows(r3 t1 t2 t3 #2)
Rows(r3 t1 t2 #2)
Rows(r3 t1 #2)
*/
EXPLAIN UPDATE s1.r3 SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
Rows(r3 t1 #2)
Rows(r3 t1 t2 #2)
Rows(r3 t1 t2 t3 #2)
Rows(r3 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
Rows(r3 t1 #2)
Rows(r3 t1 t2 #2)
Rows(r3 t1 t2 t3 #2)
Rows(r3 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3 t1 t2 t3 t4)
Rows(r3 t1 #2)
Rows(r3 t1 t2 #2)
Rows(r3 t1 t2 t3 #2)
Rows(r3 t1 t2 t3 t4 #2)
not used hint:
duplication hint:
error hint:

                                   QUERY PLAN                                    
---------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (t1.c1 = t4.c1)
         ->  Tid Scan on t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (t1.c1 = t3.c1)
               ->  Tid Scan on t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (t1.c1 = t2.c1)
                     ->  Seq Scan on t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(56 rows)

/*+
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN UPDATE s1.r3_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
*/
EXPLAIN UPDATE s1.r3_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
not used hint:
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
not used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
not used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
duplication hint:
error hint:

                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b1t1.c1 = b1t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b1t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b1t2.c1
                           ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b2t1.c1 = b2t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b2t1.c1 = b2t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b2t1.c1 = b2t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b2t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b2t2.c1
                           ->  Seq Scan on t2 b2t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b2t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b2t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
 
 Aggregate  (cost=22.39..22.40 rows=1 width=4)
   ->  Nested Loop  (cost=2.54..22.39 rows=1 width=4)
         Join Filter: (b3t1.c1 = b3t4.c1)
         ->  Nested Loop  (cost=2.54..18.36 rows=1 width=12)
               Join Filter: (b3t1.c1 = b3t3.c1)
               ->  Merge Join  (cost=2.53..14.34 rows=1 width=8)
                     Merge Cond: (b3t1.c1 = b3t2.c1)
                     ->  Nested Loop  (cost=0.28..70.96 rows=6 width=4)
                           ->  Index Scan using t1_i1 on t1 b3t1  (cost=0.28..46.77 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
                     ->  Sort  (cost=2.26..2.27 rows=1 width=4)
                           Sort Key: b3t2.c1
                           ->  Seq Scan on t2 b3t2  (cost=0.00..2.25 rows=1 width=4)
                                 Filter: (ctid = '(1,1)'::tid)
               ->  Tid Scan on t3 b3t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
         ->  Tid Scan on t4 b3t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
(62 rows)

/*+
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
Rows(r3_ b1t1 #2)
Rows(r3_ b1t1 b1t2 #2)
Rows(r3_ b1t1 b1t2 b1t3 #2)
Rows(r3_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r3_ b2t1 #2)
Rows(r3_ b2t1 b2t2 #2)
Rows(r3_ b2t1 b2t2 b2t3 #2)
Rows(r3_ b2t1 b2t2 b2t3 b2t4 #2)
Rows(r3_ b3t1 #2)
Rows(r3_ b3t1 b3t2 #2)
Rows(r3_ b3t1 b3t2 b3t3 #2)
Rows(r3_ b3t1 b3t2 b3t3 b3t4 #2)
*/
EXPLAIN UPDATE s1.r3_ SET c1 = c1 WHERE c1 = 1;
LOG:  statement: /*+
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
Rows(r3_ b1t1 #2)
Rows(r3_ b1t1 b1t2 #2)
Rows(r3_ b1t1 b1t2 b1t3 #2)
Rows(r3_ b1t1 b1t2 b1t3 b1t4 #2)
Rows(r3_ b2t1 #2)
Rows(r3_ b2t1 b2t2 #2)
Rows(r3_ b2t1 b2t2 b2t3 #2)
Rows(r3_ b2t1 b2t2 b2t3 b2t4 #2)
Rows(r3_ b3t1 #2)
Rows(r3_ b3t1 b3t2 #2)
Rows(r3_ b3t1 b3t2 b3t3 #2)
Rows(r3_ b3t1 b3t2 b3t3 b3t4 #2)
*/
EXPLAIN UPDATE s1.r3_ SET c1 = c1 WHERE c1 = 1;
LOG:  pg_hint_plan:
used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Rows(b1t1 r3_ #2)
Rows(b1t1 b1t2 r3_ #2)
Rows(b1t1 b1t2 b1t3 r3_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r3_ #2)
not used hint:
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
Rows(b2t1 r3_ #2)
Rows(b3t1 r3_ #2)
Rows(b2t1 b2t2 r3_ #2)
Rows(b3t1 b3t2 r3_ #2)
Rows(b2t1 b2t2 b2t3 r3_ #2)
Rows(b3t1 b3t2 b3t3 r3_ #2)
Rows(b2t1 b2t2 b2t3 b2t4 r3_ #2)
Rows(b3t1 b3t2 b3t3 b3t4 r3_ #2)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Rows(b2t1 r3_ #2)
Rows(b2t1 b2t2 r3_ #2)
Rows(b2t1 b2t2 b2t3 r3_ #2)
Rows(b2t1 b2t2 b2t3 b2t4 r3_ #2)
not used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
Rows(b1t1 r3_ #2)
Rows(b3t1 r3_ #2)
Rows(b1t1 b1t2 r3_ #2)
Rows(b3t1 b3t2 r3_ #2)
Rows(b1t1 b1t2 b1t3 r3_ #2)
Rows(b3t1 b3t2 b3t3 r3_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r3_ #2)
Rows(b3t1 b3t2 b3t3 b3t4 r3_ #2)
duplication hint:
error hint:

LOG:  pg_hint_plan:
used hint:
Leading(r3_ b3t1 b3t2 b3t3 b3t4)
Rows(b3t1 r3_ #2)
Rows(b3t1 b3t2 r3_ #2)
Rows(b3t1 b3t2 b3t3 r3_ #2)
Rows(b3t1 b3t2 b3t3 b3t4 r3_ #2)
not used hint:
Leading(r3_ b1t1 b1t2 b1t3 b1t4)
Leading(r3_ b2t1 b2t2 b2t3 b2t4)
Rows(b1t1 r3_ #2)
Rows(b2t1 r3_ #2)
Rows(b1t1 b1t2 r3_ #2)
Rows(b2t1 b2t2 r3_ #2)
Rows(b1t1 b1t2 b1t3 r3_ #2)
Rows(b2t1 b2t2 b2t3 r3_ #2)
Rows(b1t1 b1t2 b1t3 b1t4 r3_ #2)
Rows(b2t1 b2t2 b2t3 b2t4 r3_ #2)
duplication hint:
error hint:

                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b1t1.c1 = b1t4.c1)
         ->  Tid Scan on t4 b1t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b1t1.c1 = b1t3.c1)
               ->  Tid Scan on t3 b1t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b1t1.c1 = b1t2.c1)
                     ->  Seq Scan on t2 b1t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b1t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b2t1.c1 = b2t4.c1)
         ->  Tid Scan on t4 b2t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b2t1.c1 = b2t3.c1)
               ->  Tid Scan on t3 b2t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b2t1.c1 = b2t2.c1)
                     ->  Seq Scan on t2 b2t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b2t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
 
 Aggregate  (cost=38.55..38.56 rows=1 width=4)
   ->  Nested Loop  (cost=0.01..38.55 rows=2 width=4)
         Join Filter: (b3t1.c1 = b3t4.c1)
         ->  Tid Scan on t4 b3t4  (cost=0.00..4.01 rows=1 width=4)
               TID Cond: (ctid = '(1,1)'::tid)
         ->  Nested Loop  (cost=0.01..34.51 rows=2 width=12)
               Join Filter: (b3t1.c1 = b3t3.c1)
               ->  Tid Scan on t3 b3t3  (cost=0.00..4.01 rows=1 width=4)
                     TID Cond: (ctid = '(1,1)'::tid)
               ->  Nested Loop  (cost=0.00..30.47 rows=2 width=8)
                     Join Filter: (b3t1.c1 = b3t2.c1)
                     ->  Seq Scan on t2 b3t2  (cost=0.00..2.25 rows=1 width=4)
                           Filter: (ctid = '(1,1)'::tid)
                     ->  Nested Loop  (cost=0.00..28.20 rows=2 width=4)
                           ->  Tid Scan on t1 b3t1  (cost=0.00..4.01 rows=1 width=4)
                                 TID Cond: (ctid = '(1,1)'::tid)
                           ->  Seq Scan on r3_  (cost=0.00..24.12 rows=6 width=0)
                                 Filter: (c1 = 1)
(56 rows)

-- No. R-2-3-4
/*+HashJoin(v1t1 v1t1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1 v2 WHERE v1.c1 = v2.c1;
LOG:  statement: /*+HashJoin(v1t1 v1t1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1 v2 WHERE v1.c1 = v2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "HashJoin(v1t1 v1t1)"
DETAIL:  Relation name "v1t1" is ambiguous.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
HashJoin(v1t1 v1t1)

                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (v1t1.c1 = v1t1_1.c1)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 v1t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

/*+HashJoin(v1t1 v1t1)Rows(v1t1 v1t1 #1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1 v2 WHERE v1.c1 = v2.c1;
LOG:  statement: /*+HashJoin(v1t1 v1t1)Rows(v1t1 v1t1 #1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1 v2 WHERE v1.c1 = v2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "HashJoin(v1t1 v1t1)Rows(v1t1 v1t1 #1)"
DETAIL:  Relation name "v1t1" is ambiguous.
INFO:  pg_hint_plan: hint syntax error at or near "Rows(v1t1 v1t1 #1)"
DETAIL:  Relation name "v1t1" is ambiguous.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
error hint:
HashJoin(v1t1 v1t1)
Rows(v1t1 v1t1 #1)

                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (v1t1.c1 = v1t1_1.c1)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 v1t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

-- No. R-2-3-5
/*+NestLoop(v1t1 v1t1_)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1_ v2 WHERE v1.c1 = v2.c1;
LOG:  statement: /*+NestLoop(v1t1 v1t1_)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1_ v2 WHERE v1.c1 = v2.c1;
LOG:  pg_hint_plan:
used hint:
NestLoop(v1t1 v1t1_)
not used hint:
duplication hint:
error hint:

                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Nested Loop  (cost=0.28..352.44 rows=1000 width=30)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Index Scan using t1_i1 on t1 v1t1_  (cost=0.28..0.34 rows=1 width=15)
         Index Cond: (c1 = v1t1.c1)
(4 rows)

/*+NestLoop(v1t1 v1t1_)Rows(v1t1 v1t1_ #1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1_ v2 WHERE v1.c1 = v2.c1;
LOG:  statement: /*+NestLoop(v1t1 v1t1_)Rows(v1t1 v1t1_ #1)*/
EXPLAIN SELECT * FROM s1.v1 v1, s1.v1_ v2 WHERE v1.c1 = v2.c1;
LOG:  pg_hint_plan:
used hint:
NestLoop(v1t1 v1t1_)
Rows(v1t1 v1t1_ #1)
not used hint:
duplication hint:
error hint:

                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Nested Loop  (cost=0.28..352.44 rows=1 width=30)
   ->  Seq Scan on t1 v1t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Index Scan using t1_i1 on t1 v1t1_  (cost=0.28..0.34 rows=1 width=15)
         Index Cond: (c1 = v1t1.c1)
(4 rows)

-- No. R-2-3-6
/*+RowsHashJoin(r4t1 r4t1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r4 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+RowsHashJoin(r4t1 r4t1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r4 t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "RowsHashJoin(r4t1 r4t1)"
DETAIL:  Unrecognized hint keyword "RowsHashJoin".
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (r4t1.c1 = r4t1_1.c1)
   ->  Seq Scan on t1 r4t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 r4t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

/*+RowsHashJoin(r4t1 r4t1)Rows(r4t1 r4t1 #1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r4 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+RowsHashJoin(r4t1 r4t1)Rows(r4t1 r4t1 #1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r4 t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "RowsHashJoin(r4t1 r4t1)Rows(r4t1 r4t1 #1)"
DETAIL:  Unrecognized hint keyword "RowsHashJoin".
                                QUERY PLAN                                
--------------------------------------------------------------------------
 Hash Join  (cost=28.50..47.14 rows=1000 width=30)
   Hash Cond: (r4t1.c1 = r4t1_1.c1)
   ->  Seq Scan on t1 r4t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Hash  (cost=16.00..16.00 rows=1000 width=15)
         ->  Seq Scan on t1 r4t1_1  (cost=0.00..16.00 rows=1000 width=15)
(5 rows)

-- No. R-2-3-7
/*+NestLoop(r4t1 r5t1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r5 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+NestLoop(r4t1 r5t1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r5 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
NestLoop(r4t1 r5t1)
not used hint:
duplication hint:
error hint:

                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Nested Loop  (cost=0.28..352.44 rows=1000 width=30)
   ->  Seq Scan on t1 r4t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Index Scan using t1_i1 on t1 r5t1  (cost=0.28..0.34 rows=1 width=15)
         Index Cond: (c1 = r4t1.c1)
(4 rows)

/*+NestLoop(r4t1 r5t1)Rows(r4t1 r5t1 #1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r5 t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+NestLoop(r4t1 r5t1)Rows(r4t1 r5t1 #1)*/
EXPLAIN SELECT * FROM s1.r4 t1, s1.r5 t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
NestLoop(r4t1 r5t1)
Rows(r4t1 r5t1 #1)
not used hint:
duplication hint:
error hint:

                                 QUERY PLAN                                 
----------------------------------------------------------------------------
 Nested Loop  (cost=0.28..352.44 rows=1 width=30)
   ->  Seq Scan on t1 r4t1  (cost=0.00..16.00 rows=1000 width=15)
   ->  Index Scan using t1_i1 on t1 r5t1  (cost=0.28..0.34 rows=1 width=15)
         Index Cond: (c1 = r4t1.c1)
(4 rows)

----
---- No. R-2-4 VALUES clause
----
-- No. R-2-4-1
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Nested Loop  (cost=0.33..3.91 rows=1 width=73)
   ->  Hash Join  (cost=0.05..2.44 rows=2 width=58)
         Hash Cond: (t2.c1 = "*VALUES*".column1)
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
         ->  Hash  (cost=0.03..0.03 rows=2 width=44)
               ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..0.73 rows=1 width=15)
         Index Cond: (c1 = t2.c1)
(8 rows)

/*+ Leading(t3 t1 t2) Rows(t3 t1 #2)Rows(t3 t1 t2 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  statement: /*+ Leading(t3 t1 t2) Rows(t3 t1 #2)Rows(t3 t1 t2 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Leading(t3 t1 t2)
Rows(t1 t3 #2)
Rows(t1 t2 t3 #2)
duplication hint:
error hint:

                                   QUERY PLAN                                   
--------------------------------------------------------------------------------
 Nested Loop  (cost=0.33..3.91 rows=1 width=73)
   ->  Hash Join  (cost=0.05..2.44 rows=2 width=58)
         Hash Cond: (t2.c1 = "*VALUES*".column1)
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
         ->  Hash  (cost=0.03..0.03 rows=2 width=44)
               ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..0.73 rows=1 width=15)
         Index Cond: (c1 = t2.c1)
(8 rows)

/*+ Leading(*VALUES* t1 t2) Rows(*VALUES* t1 #2)Rows(*VALUES* t1 t2 #20)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  statement: /*+ Leading(*VALUES* t1 t2) Rows(*VALUES* t1 #2)Rows(*VALUES* t1 t2 #20)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1;
LOG:  pg_hint_plan:
used hint:
Leading(*VALUES* t1 t2)
Rows(*VALUES* t1 #2)
Rows(*VALUES* t1 t2 #20)
not used hint:
duplication hint:
error hint:

                                 QUERY PLAN                                  
-----------------------------------------------------------------------------
 Nested Loop  (cost=0.42..16.97 rows=20 width=73)
   ->  Nested Loop  (cost=0.28..16.63 rows=2 width=59)
         ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
         ->  Index Scan using t1_i1 on t1  (cost=0.28..8.29 rows=1 width=15)
               Index Cond: (c1 = "*VALUES*".column1)
   ->  Index Scan using t2_i1 on t2  (cost=0.14..0.17 rows=1 width=14)
         Index Cond: (c1 = t1.c1)
(7 rows)

-- No. R-2-4-2
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Nested Loop  (cost=0.33..3.27 rows=1 width=117)
   ->  Nested Loop  (cost=0.05..2.54 rows=1 width=102)
         Join Filter: (t2.c1 = "*VALUES*_1".column1)
         ->  Hash Join  (cost=0.05..2.44 rows=2 width=58)
               Hash Cond: (t2.c1 = "*VALUES*".column1)
               ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
               ->  Hash  (cost=0.03..0.03 rows=2 width=44)
                     ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
         ->  Materialize  (cost=0.00..0.04 rows=2 width=44)
               ->  Values Scan on "*VALUES*_1"  (cost=0.00..0.03 rows=2 width=44)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..0.73 rows=1 width=15)
         Index Cond: (c1 = t2.c1)
(12 rows)

/*+ Leading(t4 t3 t2 t1) Rows(t4 t3 #2) Rows(t4 t3 t2 #2)Rows(t4 t3 t2 t1 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
LOG:  statement: /*+ Leading(t4 t3 t2 t1) Rows(t4 t3 #2) Rows(t4 t3 t2 #2)Rows(t4 t3 t2 t1 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Leading(t4 t3 t2 t1)
Rows(t3 t4 #2)
Rows(t2 t3 t4 #2)
Rows(t1 t2 t3 t4 #2)
duplication hint:
error hint:

                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Nested Loop  (cost=0.33..3.27 rows=1 width=117)
   ->  Nested Loop  (cost=0.05..2.54 rows=1 width=102)
         Join Filter: (t2.c1 = "*VALUES*_1".column1)
         ->  Hash Join  (cost=0.05..2.44 rows=2 width=58)
               Hash Cond: (t2.c1 = "*VALUES*".column1)
               ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
               ->  Hash  (cost=0.03..0.03 rows=2 width=44)
                     ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
         ->  Materialize  (cost=0.00..0.04 rows=2 width=44)
               ->  Values Scan on "*VALUES*_1"  (cost=0.00..0.03 rows=2 width=44)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..0.73 rows=1 width=15)
         Index Cond: (c1 = t2.c1)
(12 rows)

/*+ Leading(*VALUES* t3 t2 t1) Rows(t4 t3 #2)Rows(*VALUES* t3 t2 #2)Rows(*VALUES* t3 t2 t1 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
LOG:  statement: /*+ Leading(*VALUES* t3 t2 t1) Rows(t4 t3 #2)Rows(*VALUES* t3 t2 #2)Rows(*VALUES* t3 t2 t1 #2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2, (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t3 (c1, c2, c3, c4), (VALUES(1,1,1,'1'), (2,2,2,'2')) AS t4 (c1, c2, c3, c4) WHERE t1.c1 = t2.c1 AND t1.c1 = t3.c1 AND t1.c1 = t4.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(*VALUES* t3 t2 #2)Rows(*VALUES* t3 t2 t1 #2)"
DETAIL:  Relation name "*VALUES*" is ambiguous.
INFO:  pg_hint_plan: hint syntax error at or near "Rows(*VALUES* t3 t2 t1 #2)"
DETAIL:  Relation name "*VALUES*" is ambiguous.
INFO:  pg_hint_plan: hint syntax error at or near "Leading(*VALUES* t3 t2 t1) Rows(t4 t3 #2)Rows(*VALUES* t3 t2 #2)Rows(*VALUES* t3 t2 t1 #2)"
DETAIL:  Relation name "*VALUES*" is ambiguous.
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(t3 t4 #2)
duplication hint:
error hint:
Leading(*VALUES* t3 t2 t1)
Rows(*VALUES* t2 t3 #2)
Rows(*VALUES* t1 t2 t3 #2)

                                      QUERY PLAN                                      
--------------------------------------------------------------------------------------
 Nested Loop  (cost=0.33..3.27 rows=1 width=117)
   ->  Nested Loop  (cost=0.05..2.54 rows=1 width=102)
         Join Filter: (t2.c1 = "*VALUES*_1".column1)
         ->  Hash Join  (cost=0.05..2.44 rows=2 width=58)
               Hash Cond: (t2.c1 = "*VALUES*".column1)
               ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
               ->  Hash  (cost=0.03..0.03 rows=2 width=44)
                     ->  Values Scan on "*VALUES*"  (cost=0.00..0.03 rows=2 width=44)
         ->  Materialize  (cost=0.00..0.04 rows=2 width=44)
               ->  Values Scan on "*VALUES*_1"  (cost=0.00..0.03 rows=2 width=44)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..0.73 rows=1 width=15)
         Index Cond: (c1 = t2.c1)
(12 rows)

----
---- No. R-2-5
----
-- No. R-2-5-1
EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: EXPLAIN SELECT max(bmt1.c1) FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
                                              QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 Aggregate  (cost=41.18..41.19 rows=1 width=4)
   ->  Nested Loop  (cost=5.90..40.93 rows=100 width=4)
         ->  Merge Join  (cost=5.75..19.53 rows=100 width=12)
               Merge Cond: (bmt1.c1 = bmt2.c1)
               ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
                     Merge Cond: (bmt1.c1 = bmt3.c1)
                     ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
                     ->  Index Only Scan using t3_i1 on t3 bmt3  (cost=0.15..61.10 rows=1130 width=4)
               ->  Sort  (cost=5.32..5.57 rows=100 width=4)
                     Sort Key: bmt2.c1
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
         ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
               Index Cond: (c1 = bmt1.c1)
(13 rows)

/*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt1 bmt2 bmt3 bmt4 *0.7)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt1 bmt2 bmt3 bmt4 *0.7)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt1 bmt2 bmt3 bmt4 *0.7)
not used hint:
duplication hint:
error hint:

                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Merge Join  (cost=69.53..75.68 rows=70 width=4)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
   ->  Sort  (cost=69.25..69.50 rows=100 width=12)
         Sort Key: bmt2.c1
         ->  Hash Join  (cost=38.68..65.93 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt2.c1)
               ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                           ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
(14 rows)

-- No. R-2-5-2
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Nested Loop  (cost=5.90..40.93 rows=100 width=4)
   ->  Merge Join  (cost=5.75..19.53 rows=100 width=12)
         Merge Cond: (bmt1.c1 = bmt2.c1)
         ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
               Merge Cond: (bmt1.c1 = bmt3.c1)
               ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
               ->  Index Only Scan using t3_i1 on t3 bmt3  (cost=0.15..61.10 rows=1130 width=4)
         ->  Sort  (cost=5.32..5.57 rows=100 width=4)
               Sort Key: bmt2.c1
               ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
         Index Cond: (c1 = bmt1.c1)
(12 rows)

/*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 *0.6)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt3 *0.6)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt3 bmt4 *0.6)
not used hint:
duplication hint:
error hint:

                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Merge Join  (cost=66.79..72.34 rows=60 width=4)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
   ->  Sort  (cost=66.52..66.67 rows=60 width=12)
         Sort Key: bmt2.c1
         ->  Hash Join  (cost=38.68..64.74 rows=60 width=12)
               Hash Cond: (bmt3.c1 = bmt2.c1)
               ->  Hash Join  (cost=35.43..59.70 rows=678 width=8)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                           ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
(14 rows)

-- No. R-2-5-3
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
                                           QUERY PLAN                                           
------------------------------------------------------------------------------------------------
 Nested Loop  (cost=5.90..40.93 rows=100 width=4)
   ->  Merge Join  (cost=5.75..19.53 rows=100 width=12)
         Merge Cond: (bmt1.c1 = bmt2.c1)
         ->  Merge Join  (cost=0.43..120.70 rows=1000 width=8)
               Merge Cond: (bmt1.c1 = bmt3.c1)
               ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
               ->  Index Only Scan using t3_i1 on t3 bmt3  (cost=0.15..61.10 rows=1130 width=4)
         ->  Sort  (cost=5.32..5.57 rows=100 width=4)
               Sort Key: bmt2.c1
               ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
   ->  Index Only Scan using t4_i1 on t4 bmt4  (cost=0.15..0.21 rows=1 width=4)
         Index Cond: (c1 = bmt1.c1)
(12 rows)

/*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt1 *0.5)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  statement: /*+
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt4 bmt1 *0.5)
*/
EXPLAIN SELECT bmt1.c1 FROM s1.t1 bmt1, (SELECT ctid, * FROM s1.t2 bmt2) sbmt2, (SELECT ctid, * FROM s1.t3 bmt3) sbmt3, (SELECT ctid, * FROM s1.t4 bmt4) sbmt4 WHERE bmt1.c1 = sbmt2.c1 AND bmt1.c1 = sbmt3.c1 AND bmt1.c1 = sbmt4.c1;
LOG:  pg_hint_plan:
used hint:
Leading(bmt4 bmt3 bmt2 bmt1)
Rows(bmt1 bmt4 *0.5)
not used hint:
duplication hint:
error hint:

                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Merge Join  (cost=69.53..75.68 rows=50 width=4)
   Merge Cond: (bmt1.c1 = bmt2.c1)
   ->  Index Only Scan using t1_i1 on t1 bmt1  (cost=0.28..44.27 rows=1000 width=4)
   ->  Sort  (cost=69.25..69.50 rows=100 width=12)
         Sort Key: bmt2.c1
         ->  Hash Join  (cost=38.68..65.93 rows=100 width=12)
               Hash Cond: (bmt3.c1 = bmt2.c1)
               ->  Hash Join  (cost=35.43..59.70 rows=1130 width=8)
                     Hash Cond: (bmt3.c1 = bmt4.c1)
                     ->  Seq Scan on t3 bmt3  (cost=0.00..21.30 rows=1130 width=4)
                     ->  Hash  (cost=21.30..21.30 rows=1130 width=4)
                           ->  Seq Scan on t4 bmt4  (cost=0.00..21.30 rows=1130 width=4)
               ->  Hash  (cost=2.00..2.00 rows=100 width=4)
                     ->  Seq Scan on t2 bmt2  (cost=0.00..2.00 rows=100 width=4)
(14 rows)

----
---- No. R-3-1 abusolute value
----
-- No. R-3-1-1
/*+Rows(t1 t2 #0)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #0)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
WARNING:  Force estimate to be at least one row, to avoid possible divide-by-zero when interpolating costs : Rows(t1 t2 #0)
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #0)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-1-2
/*+Rows(t1 t2 #5)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #5)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #5)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=5 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-3-2 increase or decrease value
----
-- No. R-3-2-1
/*+Rows(t1 t2 +1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 +1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 +1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=101 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-2-2
/*+Rows(t1 t2 -1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 -1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 -1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=99 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-2-3
/*+Rows(t1 t2 -1000)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 -1000)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
WARNING:  Force estimate to be at least one row, to avoid possible divide-by-zero when interpolating costs : Rows(t1 t2 -1000)
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 -1000)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-3-3 multiple 
----
-- No. R-3-3-1
/*+Rows(t1 t2 *0)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 *0)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
WARNING:  Force estimate to be at least one row, to avoid possible divide-by-zero when interpolating costs : Rows(t1 t2 *0)
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 *0)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-3-2
/*+Rows(t1 t2 *2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 *2)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 *2)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=200 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-3-3
/*+Rows(t1 t2 *0.1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 *0.1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 *0.1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=10 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-3-4 join inherit tables
----
-- No. R-3-4-1
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Hash Join  (cost=11.27..25.94 rows=301 width=31)
   Hash Cond: (p2.c1 = p1.c1)
   ->  Append  (cost=0.00..10.52 rows=304 width=16)
         ->  Seq Scan on p2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c3  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1c1  (cost=0.00..1.50 rows=50 width=14)
         ->  Seq Scan on p2c1c2  (cost=0.00..1.50 rows=50 width=15)
         ->  Seq Scan on p2c2c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c2c2  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c2  (cost=0.00..1.50 rows=50 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3  (cost=0.00..2.00 rows=100 width=16)
(19 rows)

/*+Rows(p1 p2 #1)*/
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  statement: /*+Rows(p1 p2 #1)*/
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  pg_hint_plan:
used hint:
Rows(p1 p2 #1)
not used hint:
duplication hint:
error hint:

                               QUERY PLAN                                
-------------------------------------------------------------------------
 Hash Join  (cost=11.27..25.94 rows=1 width=31)
   Hash Cond: (p2.c1 = p1.c1)
   ->  Append  (cost=0.00..10.52 rows=304 width=16)
         ->  Seq Scan on p2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c3  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1c1  (cost=0.00..1.50 rows=50 width=14)
         ->  Seq Scan on p2c1c2  (cost=0.00..1.50 rows=50 width=15)
         ->  Seq Scan on p2c2c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c2c2  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c2  (cost=0.00..1.50 rows=50 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3  (cost=0.00..2.00 rows=100 width=16)
(19 rows)

-- No. R-3-4-2
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
                               QUERY PLAN                                
-------------------------------------------------------------------------
 Hash Join  (cost=11.27..25.94 rows=301 width=31)
   Hash Cond: (p2.c1 = p1.c1)
   ->  Append  (cost=0.00..10.52 rows=304 width=16)
         ->  Seq Scan on p2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c3  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1c1  (cost=0.00..1.50 rows=50 width=14)
         ->  Seq Scan on p2c1c2  (cost=0.00..1.50 rows=50 width=15)
         ->  Seq Scan on p2c2c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c2c2  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c2  (cost=0.00..1.50 rows=50 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3  (cost=0.00..2.00 rows=100 width=16)
(19 rows)

/*+Rows(p1c1 p2c1 #1)*/
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  statement: /*+Rows(p1c1 p2c1 #1)*/
EXPLAIN SELECT * FROM s1.p1, s1.p2 WHERE p1.c1 = p2.c1;
LOG:  pg_hint_plan:
used hint:
not used hint:
Rows(p1c1 p2c1 #1)
duplication hint:
error hint:

                               QUERY PLAN                                
-------------------------------------------------------------------------
 Hash Join  (cost=11.27..25.94 rows=301 width=31)
   Hash Cond: (p2.c1 = p1.c1)
   ->  Append  (cost=0.00..10.52 rows=304 width=16)
         ->  Seq Scan on p2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c2  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c3  (cost=0.00..0.00 rows=1 width=44)
         ->  Seq Scan on p2c1c1  (cost=0.00..1.50 rows=50 width=14)
         ->  Seq Scan on p2c1c2  (cost=0.00..1.50 rows=50 width=15)
         ->  Seq Scan on p2c2c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c2c2  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c1  (cost=0.00..1.50 rows=50 width=16)
         ->  Seq Scan on p2c3c2  (cost=0.00..1.50 rows=50 width=16)
   ->  Hash  (cost=7.50..7.50 rows=301 width=15)
         ->  Append  (cost=0.00..7.50 rows=301 width=15)
               ->  Seq Scan on p1  (cost=0.00..0.00 rows=1 width=44)
               ->  Seq Scan on p1c1  (cost=0.00..2.00 rows=100 width=14)
               ->  Seq Scan on p1c2  (cost=0.00..2.00 rows=100 width=16)
               ->  Seq Scan on p1c3  (cost=0.00..2.00 rows=100 width=16)
(19 rows)

----
---- No. R-3-5 conflict join method hint
----
-- No. R-3-5-1
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 t2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t2 #1)Rows(t1 t2 #1)"
DETAIL:  Conflict rows hint.
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
Rows(t1 t2 #1)
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-5-2
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 t2 #1)Rows(t1 t2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)Rows(t1 t2 #1)Rows(t1 t2 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t2 #1)Rows(t1 t2 #1)Rows(t1 t2 #1)"
DETAIL:  Conflict rows hint.
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t2 #1)Rows(t1 t2 #1)"
DETAIL:  Conflict rows hint.
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
Rows(t1 t2 #1)
Rows(t1 t2 #1)
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-5-3
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 t2 #1)Rows(t2 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 #1)Rows(t2 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t2 #1)Rows(t2 t1 #1)"
DETAIL:  Conflict rows hint.
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
Rows(t1 t2 #1)
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

-- No. R-3-5-4
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t2 t1 #1)Rows(t1 t2 #1)Rows(t2 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t2 t1 #1)Rows(t1 t2 #1)Rows(t2 t1 #1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t2 t1 #1)Rows(t1 t2 #1)Rows(t2 t1 #1)"
DETAIL:  Conflict rows hint.
INFO:  pg_hint_plan: hint syntax error at or near "Rows(t1 t2 #1)Rows(t2 t1 #1)"
DETAIL:  Conflict rows hint.
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 #1)
not used hint:
duplication hint:
Rows(t1 t2 #1)
Rows(t1 t2 #1)
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=1 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

----
---- No. R-3-6 hint state output
----
-- No. R-3-6-1
SET client_min_messages TO DEBUG1;
LOG:  statement: SET client_min_messages TO DEBUG1;
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=100 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

/*+Rows(t1 t2 +1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
LOG:  statement: /*+Rows(t1 t2 +1)*/
EXPLAIN SELECT * FROM s1.t1, s1.t2 WHERE t1.c1 = t2.c1;
DEBUG:  adjusted rows 100 to 101
LOG:  pg_hint_plan:
used hint:
Rows(t1 t2 +1)
not used hint:
duplication hint:
error hint:

                                QUERY PLAN                                 
---------------------------------------------------------------------------
 Merge Join  (cost=5.60..11.75 rows=101 width=29)
   Merge Cond: (t1.c1 = t2.c1)
   ->  Index Scan using t1_i1 on t1  (cost=0.28..44.27 rows=1000 width=15)
   ->  Sort  (cost=5.32..5.57 rows=100 width=14)
         Sort Key: t2.c1
         ->  Seq Scan on t2  (cost=0.00..2.00 rows=100 width=14)
(6 rows)

